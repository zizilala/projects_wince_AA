; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\Z2170P\SRC\APP\KeyHook\KBHook.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?m_hTargetWnd@KBHook@@1PAUHWND__@@A| [ DATA ] ; KBHook::m_hTargetWnd
	EXPORT	|?m_hHook@KBHook@@1PAUHHOOK__@@A| [ DATA ] ; KBHook::m_hHook

  00000			 AREA	 |.bss|, NOINIT
|?m_hTargetWnd@KBHook@@1PAUHWND__@@A| % 0x4		; KBHook::m_hTargetWnd
|?m_hHook@KBHook@@1PAUHHOOK__@@A| % 0x4			; KBHook::m_hHook
	EXPORT	|??0KBHook@@QAA@XZ|			; KBHook::KBHook
	EXPORT	|??_7KBHook@@6B@| [ DATA ]		; KBHook::`vftable'
	IMPORT	|??_EKBHook@@UAAPAXI@Z|, WEAK |??_GKBHook@@UAAPAXI@Z| ; KBHook::`vector deleting destructor', KBHook::`scalar deleting destructor'
; File c:\wince600\platform\z2170p\src\app\keyhook\kbhook.cpp

  00000			 AREA	 |.pdata|, PDATA
|$T31956| DCD	|$LN5@KBHook|
	DCD	0x40000500

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_7KBHook@@6B@| DCD |??_EKBHook@@UAAPAXI@Z|		; KBHook::`vftable'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |??0KBHook@@QAA@XZ| PROC		; KBHook::KBHook

; 9    : {}

  00000		 |$LN5@KBHook|
  00000		 |$M31953|
  00000	e1a02000	 mov         r2, r0
  00004	e59f3004	 ldr         r3, [pc, #4]
  00008	e5823000	 str         r3, [r2]
  0000c	e12fff1e	 bx          lr
  00010		 |$LN6@KBHook|
  00010		 |$LN7@KBHook|
  00010	00000000	 DCD         |??_7KBHook@@6B@|
  00014		 |$M31954|

			 ENDP  ; |??0KBHook@@QAA@XZ|, KBHook::KBHook

	EXPORT	|??1KBHook@@UAA@XZ|			; KBHook::~KBHook

  00000			 AREA	 |.pdata|, PDATA
|$T31966| DCD	|$LN5@KBHook@2|
	DCD	0x40000400
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |??1KBHook@@UAA@XZ| PROC		; KBHook::~KBHook

; 12   : {}

  00000		 |$LN5@KBHook@2|
  00000		 |$M31963|
  00000	e59f3004	 ldr         r3, [pc, #4]
  00004	e5803000	 str         r3, [r0]
  00008	e12fff1e	 bx          lr
  0000c		 |$LN6@KBHook@2|
  0000c		 |$LN7@KBHook@2|
  0000c	00000000	 DCD         |??_7KBHook@@6B@|
  00010		 |$M31964|

			 ENDP  ; |??1KBHook@@UAA@XZ|, KBHook::~KBHook

	EXPORT	|?StopKBHook@KBHook@@QAAHXZ|		; KBHook::StopKBHook
	IMPORT	|UnhookWindowsHookEx|

  00000			 AREA	 |.pdata|, PDATA
|$T31978| DCD	|$LN5@StopKBHook|
	DCD	0x40000901
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?StopKBHook@KBHook@@QAAHXZ| PROC	; KBHook::StopKBHook

; 31   : {

  00000		 |$LN5@StopKBHook|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M31975|

; 32   :     BOOL bResult = UnhookWindowsHookEx ( m_hHook );

  00004	e59f4014	 ldr         r4, [pc, #0x14]
  00008	e5940000	 ldr         r0, [r4]
  0000c	eb000000	 bl          UnhookWindowsHookEx

; 33   :     m_hHook = NULL;

  00010	e3a03000	 mov         r3, #0

; 34   : 
; 35   :     return bResult;
; 36   : }

  00014	e5843000	 str         r3, [r4]
  00018	e8bd4010	 ldmia       sp!, {r4, lr}
  0001c	e12fff1e	 bx          lr
  00020		 |$LN6@StopKBHook|
  00020		 |$LN7@StopKBHook|
  00020	00000000	 DCD         |?m_hHook@KBHook@@1PAUHHOOK__@@A|
  00024		 |$M31976|

			 ENDP  ; |?StopKBHook@KBHook@@QAAHXZ|, KBHook::StopKBHook

	EXPORT	|?KBHookProc@KBHook@@SAJHIJ@Z|		; KBHook::KBHookProc
	IMPORT	|CallNextHookEx|
	IMPORT	|SendMessageW|

  00000			 AREA	 |.pdata|, PDATA
|$T31992| DCD	|$LN5@KBHookProc|
	DCD	0x40001301
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?KBHookProc@KBHook@@SAJHIJ@Z| PROC	; KBHook::KBHookProc

; 41   : {

  00000		 |$LN5@KBHookProc|
  00000	e92d40f0	 stmdb       sp!, {r4 - r7, lr}
  00004		 |$M31989|
  00004	e1a05002	 mov         r5, r2
  00008	e1a06001	 mov         r6, r1
  0000c	e1a07000	 mov         r7, r0

; 42   : 	SendMessage ( KBHook::m_hTargetWnd, WM_KBHOOK_NOTIFY, wParam, lParam );

  00010	e59f4030	 ldr         r4, [pc, #0x30]
  00014	e3a01902	 mov         r1, #2, 18
  00018	e1a03005	 mov         r3, r5
  0001c	e5940000	 ldr         r0, [r4]
  00020	e1a02006	 mov         r2, r6
  00024	e38110aa	 orr         r1, r1, #0xAA
  00028	eb000000	 bl          SendMessageW

; 43   :     
; 44   :     return CallNextHookEx ( KBHook::m_hHook, nCode, wParam, lParam );

  0002c	e5940004	 ldr         r0, [r4, #4]
  00030	e1a03005	 mov         r3, r5
  00034	e1a02006	 mov         r2, r6
  00038	e1a01007	 mov         r1, r7
  0003c	eb000000	 bl          CallNextHookEx

; 45   : }

  00040	e8bd40f0	 ldmia       sp!, {r4 - r7, lr}
  00044	e12fff1e	 bx          lr
  00048		 |$LN6@KBHookProc|
  00048		 |$LN7@KBHookProc|
  00048	00000000	 DCD         |?m_hTargetWnd@KBHook@@1PAUHWND__@@A|
  0004c		 |$M31990|

			 ENDP  ; |?KBHookProc@KBHook@@SAJHIJ@Z|, KBHook::KBHookProc

	IMPORT	|??3@YAXPAX@Z|				; operator delete

  00000			 AREA	 |.pdata|, PDATA
|$T32008| DCD	|$LN8@scalar|
	DCD	0x40000a01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |??_GKBHook@@UAAPAXI@Z| PROC		; KBHook::`scalar deleting destructor'
  00000		 |$LN8@scalar|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M32005|
  00004	e1a04000	 mov         r4, r0
  00008	e59f3014	 ldr         r3, [pc, #0x14]
  0000c	e3110001	 tst         r1, #1
  00010	e5843000	 str         r3, [r4]
  00014	1b000000	 blne        |??3@YAXPAX@Z|
  00018	e1a00004	 mov         r0, r4
  0001c	e8bd4010	 ldmia       sp!, {r4, lr}
  00020	e12fff1e	 bx          lr
  00024		 |$LN9@scalar|
  00024		 |$LN10@scalar|
  00024	00000000	 DCD         |??_7KBHook@@6B@|
  00028		 |$M32006|

			 ENDP  ; |??_GKBHook@@UAAPAXI@Z|, KBHook::`scalar deleting destructor'

	EXPORT	|?StartKBHook@KBHook@@QAAHPAUHWND__@@PAUHINSTANCE__@@@Z| ; KBHook::StartKBHook
	IMPORT	|SetWindowsHookExW|

  00000			 AREA	 |.pdata|, PDATA
|$T32027| DCD	|$LN10@StartKBHoo|
	DCD	0x40001801
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?StartKBHook@KBHook@@QAAHPAUHWND__@@PAUHINSTANCE__@@@Z| PROC ; KBHook::StartKBHook

; 17   : {

  00000		 |$LN10@StartKBHoo|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004		 |$M32024|
  00004	e1a05002	 mov         r5, r2

; 18   :     ASSERT ( IsWindow ( hWnd ) );
; 19   : 
; 20   :     m_hTargetWnd = hWnd;

  00008	e59f404c	 ldr         r4, [pc, #0x4C]

; 21   : 
; 22   :     if ( m_hHook != NULL )

  0000c	e5940004	 ldr         r0, [r4, #4]
  00010	e5841000	 str         r1, [r4]
  00014	e3500000	 cmp         r0, #0
  00018	0a000002	 beq         |$LN6@StartKBHoo|

; 23   :         StopKBHook();

  0001c	eb000000	 bl          UnhookWindowsHookEx
  00020	e3a03000	 mov         r3, #0
  00024	e5843004	 str         r3, [r4, #4]
  00028		 |$LN6@StartKBHoo|

; 24   : 
; 25   :     m_hHook = SetWindowsHookEx ( WH_KEYBOARD_LL, KBHookProc, hInstance, 0);

  00028	e59f1028	 ldr         r1, [pc, #0x28]
  0002c	e3a03000	 mov         r3, #0
  00030	e1a02005	 mov         r2, r5
  00034	e3a00014	 mov         r0, #0x14
  00038	eb000000	 bl          SetWindowsHookExW
  0003c	e3500000	 cmp         r0, #0
  00040	e5840004	 str         r0, [r4, #4]

; 26   : 
; 27   :     return (m_hHook == NULL ? FALSE : TRUE);

  00044	03a00000	 moveq       r0, #0

; 28   : }

  00048	08bd4030	 ldmeqia     sp!, {r4, r5, lr}

; 26   : 
; 27   :     return (m_hHook == NULL ? FALSE : TRUE);

  0004c	13a00001	 movne       r0, #1

; 28   : }

  00050	18bd4030	 ldmneia     sp!, {r4, r5, lr}
  00054	e12fff1e	 bx          lr
  00058		 |$LN11@StartKBHoo|
  00058		 |$LN12@StartKBHoo|
  00058	00000000	 DCD         |?KBHookProc@KBHook@@SAJHIJ@Z|
  0005c		 |$LN13@StartKBHoo|
  0005c	00000000	 DCD         |?m_hTargetWnd@KBHook@@1PAUHWND__@@A|
  00060		 |$M32025|

			 ENDP  ; |?StartKBHook@KBHook@@QAAHPAUHWND__@@PAUHINSTANCE__@@@Z|, KBHook::StartKBHook

	END
