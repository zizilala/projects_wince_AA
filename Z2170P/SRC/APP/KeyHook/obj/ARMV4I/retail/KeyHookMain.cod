; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\Z2170P\SRC\APP\KeyHook\KeyHookMain.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?KeyHookDlgProc@@YAHPAUHWND__@@IIJ@Z|	; KeyHookDlgProc
	EXPORT	|??_C@_1BG@KBNMNJAO@?$AAF?$AAu?$AAn?$AAK?$AAe?$AAy?$AAH?$AAo?$AAo?$AAk?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1FI@KHNHLMMH@?$AAO?$AAn?$AAK?$AAB?$AAH?$AAo?$AAo?$AAk?$AA?5?$AA?$CI?$AAv?$AAk?$AAC?$AAo?$AAd?$AAe?$AA?3?$AA?$CF?$AAx?$AA?5?$AAs?$AAc?$AAa?$AAn?$AAC?$AAo?$AAd?$AAe?$AA?3?$AA?$CF?$AAx?$AA?5@| [ DATA ] ; `string'
	IMPORT	|PostQuitMessage|
	IMPORT	|SetWindowTextW|
	IMPORT	|ShowWindow|
	IMPORT	|?StopKBHook@KBHook@@QAAHXZ|		; KBHook::StopKBHook
	IMPORT	|?StartKBHook@KBHook@@QAAHPAUHWND__@@PAUHINSTANCE__@@@Z| ; KBHook::StartKBHook
	IMPORT	|PostMessageW|
	IMPORT	|GetForegroundWindow|
	IMPORT	|NKDbgPrintfW|
	IMPORT	|??1KBHook@@UAA@XZ|			; KBHook::~KBHook
	IMPORT	|??0KBHook@@QAA@XZ|			; KBHook::KBHook
; File c:\wince600\platform\z2170p\src\app\keyhook\keyhookmain.cpp

  00000			 AREA	 |.bss|, NOINIT
|?HookState@?1??KeyHookDlgProc@@YAHPAUHWND__@@IIJ@Z@4HA| % 0x4 ; `KeyHookDlgProc'::`2'::HookState

  00000			 AREA	 |.pdata|, PDATA
|$T32011| DCD	|$LN20@KeyHookDlg|
	DCD	0x40006202

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1BG@KBNMNJAO@?$AAF?$AAu?$AAn?$AAK?$AAe?$AAy?$AAH?$AAo?$AAo?$AAk?$AA?$AA@| DCB "F"
	DCB	0x0, "u", 0x0, "n", 0x0, "K", 0x0, "e", 0x0, "y", 0x0, "H"
	DCB	0x0, "o", 0x0, "o", 0x0, "k", 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FI@KHNHLMMH@?$AAO?$AAn?$AAK?$AAB?$AAH?$AAo?$AAo?$AAk?$AA?5?$AA?$CI?$AAv?$AAk?$AAC?$AAo?$AAd?$AAe?$AA?3?$AA?$CF?$AAx?$AA?5?$AAs?$AAc?$AAa?$AAn?$AAC?$AAo?$AAd?$AAe?$AA?3?$AA?$CF?$AAx?$AA?5@| DCB "O"
	DCB	0x0, "n", 0x0, "K", 0x0, "B", 0x0, "H", 0x0, "o", 0x0, "o"
	DCB	0x0, "k", 0x0, " ", 0x0, "(", 0x0, "v", 0x0, "k", 0x0, "C"
	DCB	0x0, "o", 0x0, "d", 0x0, "e", 0x0, ":", 0x0, "%", 0x0, "x"
	DCB	0x0, " ", 0x0, "s", 0x0, "c", 0x0, "a", 0x0, "n", 0x0, "C"
	DCB	0x0, "o", 0x0, "d", 0x0, "e", 0x0, ":", 0x0, "%", 0x0, "x"
	DCB	0x0, " ", 0x0, "e", 0x0, "v", 0x0, "e", 0x0, "n", 0x0, "t"
	DCB	0x0, ":", 0x0, "%", 0x0, "x", 0x0, ")", 0x0, 0xd, 0x0, 0xa
	DCB	0x0, 0x0, 0x0				; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?KeyHookDlgProc@@YAHPAUHWND__@@IIJ@Z| PROC ; KeyHookDlgProc

; 40   : {

  00000		 |$LN20@KeyHookDlg|
  00000	e92d40f0	 stmdb       sp!, {r4 - r7, lr}
  00004	e24dd004	 sub         sp, sp, #4
  00008		 |$M32008|
  00008	e1a05003	 mov         r5, r3
  0000c	e1a06002	 mov         r6, r2
  00010	e1a04001	 mov         r4, r1
  00014	e1a07000	 mov         r7, r0

; 41   : 	KBHook m_KBHook;

  00018	e28d0000	 add         r0, sp, #0
  0001c	eb000000	 bl          |??0KBHook@@QAA@XZ|

; 42   : 	PKBDLLHOOKSTRUCT KBScan;
; 43   : 	HWND hWnd;
; 44   : 	static BOOL HookState = FALSE;
; 45   : 
; 46   : 	switch (message)

  00020	e3540002	 cmp         r4, #2
  00024	0a00004c	 beq         |$LN7@KeyHookDlg|
  00028	e3540e11	 cmp         r4, #0x11, 28
  0002c	0a00003c	 beq         |$LN11@KeyHookDlg|
  00030	e3a03c01	 mov         r3, #1, 24
  00034	e383e011	 orr         lr, r3, #0x11
  00038	e154000e	 cmp         r4, lr
  0003c	0a00002e	 beq         |$LN10@KeyHookDlg|
  00040	e3a03902	 mov         r3, #2, 18
  00044	e383e0a4	 orr         lr, r3, #0xA4
  00048	e154000e	 cmp         r4, lr
  0004c	0a000023	 beq         |$LN4@KeyHookDlg|
  00050	e3a03902	 mov         r3, #2, 18
  00054	e383e0a5	 orr         lr, r3, #0xA5
  00058	e154000e	 cmp         r4, lr
  0005c	0a000015	 beq         |$LN2@KeyHookDlg|
  00060	e3a03902	 mov         r3, #2, 18
  00064	e38330aa	 orr         r3, r3, #0xAA
  00068	e1540003	 cmp         r4, r3
  0006c	0a000003	 beq         |$LN6@KeyHookDlg|

; 84   : 	}
; 85   : 	
; 86   : 	return FALSE;

  00070	e28d0000	 add         r0, sp, #0
  00074	eb000000	 bl          |??1KBHook@@UAA@XZ|
  00078	e3a00000	 mov         r0, #0
  0007c	ea00003b	 b           |$LN14@KeyHookDlg|
  00080		 |$LN6@KeyHookDlg|

; 61   : 			return TRUE;
; 62   : 
; 63   : 		case WM_KBHOOK_NOTIFY:
; 64   : 			KBScan = (PKBDLLHOOKSTRUCT) lParam;
; 65   : 			RETAILMSG (1, (TEXT("OnKBHook (vkCode:%x scanCode:%x event:%x)\r\n"),KBScan->vkCode,KBScan->scanCode,wParam));

  00080	e5952004	 ldr         r2, [r5, #4]
  00084	e5951000	 ldr         r1, [r5]
  00088	e59f00f4	 ldr         r0, [pc, #0xF4]
  0008c	e1a03006	 mov         r3, r6
  00090	eb000000	 bl          NKDbgPrintfW

; 66   : 			hWnd = GetForegroundWindow();

  00094	eb000000	 bl          GetForegroundWindow
  00098	e3500000	 cmp         r0, #0

; 67   : 			if(hWnd)

  0009c	0a000030	 beq         |$LN5@KeyHookDlg|

; 68   : 				PostMessage(hWnd, WM_KEY_EVENT_NOTIFY,KBScan->vkCode, wParam);

  000a0	e5952000	 ldr         r2, [r5]
  000a4	e3a03902	 mov         r3, #2, 18
  000a8	e38310bc	 orr         r1, r3, #0xBC
  000ac	e1a03006	 mov         r3, r6
  000b0	eb000000	 bl          PostMessageW

; 69   : 			//======================================
; 70   : 			//Function Key --> Quick Launch
; 71   : 			//======================================
; 72   : 			//FuncKeyHandle(KBScan->vkCode,wParam);
; 73   : 			return TRUE;  		          

  000b4	ea00002a	 b           |$LN5@KeyHookDlg|
  000b8		 |$LN2@KeyHookDlg|

; 79   : 
; 80   : 		case KEY_HOOK_ON:
; 81   : 			if (HookState == FALSE) 

  000b8	e59f40bc	 ldr         r4, [pc, #0xBC]
  000bc	e5943000	 ldr         r3, [r4]
  000c0	e3530000	 cmp         r3, #0
  000c4	1a000026	 bne         |$LN5@KeyHookDlg|

; 82   : 				HookState = m_KBHook.StartKBHook(hDlg,(HINSTANCE)lParam );

  000c8	e1a02005	 mov         r2, r5
  000cc	e1a01007	 mov         r1, r7
  000d0	e28d0000	 add         r0, sp, #0
  000d4	eb000000	 bl          |?StartKBHook@KBHook@@QAAHPAUHWND__@@PAUHINSTANCE__@@@Z|
  000d8	e5840000	 str         r0, [r4]

; 83   : 			return TRUE;

  000dc	ea000020	 b           |$LN5@KeyHookDlg|
  000e0		 |$LN4@KeyHookDlg|

; 74   : 	             		         	                	         
; 75   : 		case KEY_HOOK_OFF:
; 76   : 			if (HookState)

  000e0	e59f3094	 ldr         r3, [pc, #0x94]
  000e4	e5933000	 ldr         r3, [r3]
  000e8	e3530000	 cmp         r3, #0
  000ec	0a00001c	 beq         |$LN5@KeyHookDlg|

; 77   : 				m_KBHook.StopKBHook();

  000f0	e28d0000	 add         r0, sp, #0
  000f4	eb000000	 bl          |?StopKBHook@KBHook@@QAAHXZ|

; 78   : 			return TRUE;

  000f8	ea000019	 b           |$LN5@KeyHookDlg|
  000fc		 |$LN10@KeyHookDlg|

; 53   : 
; 54   : 		case WM_COMMAND:
; 55   : 			if ((LOWORD(wParam) == IDCANCEL) || (LOWORD(wParam)==IDOK))

  000fc	e1a03806	 mov         r3, r6, lsl #16
  00100	e1a03823	 mov         r3, r3, lsr #16
  00104	e3530002	 cmp         r3, #2
  00108	0a000001	 beq         |$LN8@KeyHookDlg|
  0010c	e3530001	 cmp         r3, #1
  00110	1a000013	 bne         |$LN5@KeyHookDlg|
  00114		 |$LN8@KeyHookDlg|

; 56   : 				ShowWindow(hDlg, SW_HIDE);

  00114	e3a01000	 mov         r1, #0
  00118	e1a00007	 mov         r0, r7
  0011c	eb000000	 bl          ShowWindow

; 57   : 			return TRUE;

  00120	ea00000f	 b           |$LN5@KeyHookDlg|
  00124		 |$LN11@KeyHookDlg|

; 47   : 	{
; 48   : 		case WM_INITDIALOG:
; 49   : 			SetWindowText(hDlg,KEY_HOOK_WND);

  00124	e59f1054	 ldr         r1, [pc, #0x54]
  00128	e1a00007	 mov         r0, r7
  0012c	eb000000	 bl          SetWindowTextW

; 50   : 			ShowWindow(hDlg, SW_HIDE);

  00130	e3a01000	 mov         r1, #0
  00134	e1a00007	 mov         r0, r7
  00138	eb000000	 bl          ShowWindow

; 51   : 			HookState = m_KBHook.StartKBHook(hDlg,(HINSTANCE)lParam );

  0013c	e1a02005	 mov         r2, r5
  00140	e1a01007	 mov         r1, r7
  00144	e28d0000	 add         r0, sp, #0
  00148	eb000000	 bl          |?StartKBHook@KBHook@@QAAHPAUHWND__@@PAUHINSTANCE__@@@Z|
  0014c	e59f2028	 ldr         r2, [pc, #0x28]
  00150	e1a03000	 mov         r3, r0

; 52   : 			return TRUE;

  00154	e5823000	 str         r3, [r2]
  00158	ea000001	 b           |$LN5@KeyHookDlg|
  0015c		 |$LN7@KeyHookDlg|

; 58   : 
; 59   :         case WM_DESTROY:
; 60   : 			PostQuitMessage(0);

  0015c	e3a00000	 mov         r0, #0
  00160	eb000000	 bl          PostQuitMessage

; 68   : 				PostMessage(hWnd, WM_KEY_EVENT_NOTIFY,KBScan->vkCode, wParam);

  00164		 |$LN5@KeyHookDlg|
  00164	e28d0000	 add         r0, sp, #0
  00168	eb000000	 bl          |??1KBHook@@UAA@XZ|
  0016c	e3a00001	 mov         r0, #1
  00170		 |$LN14@KeyHookDlg|

; 87   : }

  00170	e28dd004	 add         sp, sp, #4
  00174	e8bd40f0	 ldmia       sp!, {r4 - r7, lr}
  00178	e12fff1e	 bx          lr
  0017c		 |$LN21@KeyHookDlg|
  0017c		 |$LN22@KeyHookDlg|
  0017c	00000000	 DCD         |?HookState@?1??KeyHookDlgProc@@YAHPAUHWND__@@IIJ@Z@4HA|
  00180		 |$LN23@KeyHookDlg|
  00180	00000000	 DCD         |??_C@_1BG@KBNMNJAO@?$AAF?$AAu?$AAn?$AAK?$AAe?$AAy?$AAH?$AAo?$AAo?$AAk?$AA?$AA@|
  00184		 |$LN24@KeyHookDlg|
  00184	00000000	 DCD         |??_C@_1FI@KHNHLMMH@?$AAO?$AAn?$AAK?$AAB?$AAH?$AAo?$AAo?$AAk?$AA?5?$AA?$CI?$AAv?$AAk?$AAC?$AAo?$AAd?$AAe?$AA?3?$AA?$CF?$AAx?$AA?5?$AAs?$AAc?$AAa?$AAn?$AAC?$AAo?$AAd?$AAe?$AA?3?$AA?$CF?$AAx?$AA?5@|
  00188		 |$M32009|

			 ENDP  ; |?KeyHookDlgProc@@YAHPAUHWND__@@IIJ@Z|, KeyHookDlgProc

	EXPORT	|?FuncKeyHandle@@YAXKK@Z|		; FuncKeyHandle

  00000			 AREA	 |.pdata|, PDATA
|$T32023| DCD	|$LN5@FuncKeyHan|
	DCD	0x40000100
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?FuncKeyHandle@@YAXKK@Z| PROC		; FuncKeyHandle

; 90   : {

  00000		 |$LN5@FuncKeyHan|
  00000		 |$M32020|

; 91   : 	UNREFERENCED_PARAMETER(VKCode);
; 92   : 	UNREFERENCED_PARAMETER(KEY_MESSAGE);
; 93   : 	
; 94   : 	
; 95   : }

  00000	e12fff1e	 bx          lr
  00004		 |$M32021|

			 ENDP  ; |?FuncKeyHandle@@YAXKK@Z|, FuncKeyHandle

	EXPORT	|WinMain|
	EXPORT	|??_C@_1DC@OLKPMOAM@?$AA?$CK?$AA?$CK?$AA?$CK?$AA?5?$AAS?$AAt?$AAa?$AAr?$AAt?$AA?5?$AAK?$AAe?$AAy?$AA?5?$AAH?$AAo?$AAo?$AAk?$AA?5?$AA?$CK?$AA?$CK?$AA?$CK?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	IMPORT	|GetMessageW|
	IMPORT	|DispatchMessageW|
	IMPORT	|TranslateMessage|
	IMPORT	|CreateDialogIndirectParamW|
	IMPORT	|LoadResource|
	IMPORT	|FindResourceW|
	IMPORT	|FindWindowW|

  00000			 AREA	 |.pdata|, PDATA
|$T32039| DCD	|$LN14@WinMain|
	DCD	0x40002a02

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DC@OLKPMOAM@?$AA?$CK?$AA?$CK?$AA?$CK?$AA?5?$AAS?$AAt?$AAa?$AAr?$AAt?$AA?5?$AAK?$AAe?$AAy?$AA?5?$AAH?$AAo?$AAo?$AAk?$AA?5?$AA?$CK?$AA?$CK?$AA?$CK?$AA?$AN?$AA?6?$AA?$AA@| DCB "*"
	DCB	0x0, "*", 0x0, "*", 0x0, " ", 0x0, "S", 0x0, "t", 0x0, "a"
	DCB	0x0, "r", 0x0, "t", 0x0, " ", 0x0, "K", 0x0, "e", 0x0, "y"
	DCB	0x0, " ", 0x0, "H", 0x0, "o", 0x0, "o", 0x0, "k", 0x0, " "
	DCB	0x0, "*", 0x0, "*", 0x0, "*", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |WinMain| PROC

; 13   : {

  00000		 |$LN14@WinMain|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004	e24dd020	 sub         sp, sp, #0x20
  00008		 |$M32036|
  00008	e1a04000	 mov         r4, r0

; 14   : 	HWND hwnd;
; 15   : 	MSG  msg;
; 16   : 
; 17   : 	UNREFERENCED_PARAMETER(lpCmdLine);
; 18   : 	UNREFERENCED_PARAMETER(hPrevInstance);
; 19   : 	UNREFERENCED_PARAMETER(nCmdShow);
; 20   : 	
; 21   : 	if(FindWindow(NULL,KEY_HOOK_WND))

  0000c	e59f1090	 ldr         r1, [pc, #0x90]
  00010	e3a00000	 mov         r0, #0
  00014	eb000000	 bl          FindWindowW
  00018	e3500000	 cmp         r0, #0

; 22   : 	{
; 23   : 		return 0;

  0001c	1a00001a	 bne         |$LN1@WinMain|

; 24   : 	}	
; 25   : 	RETAILMSG (1, (TEXT("*** Start Key Hook ***\r\n")));   

  00020	e59f0078	 ldr         r0, [pc, #0x78]
  00024	eb000000	 bl          NKDbgPrintfW

; 26   : 	       
; 27   : 	//creat the main window	        
; 28   : 	hwnd =(HWND) CreateDialogParam(hInstance, MAKEINTRESOURCE(IDD_FnKey_Dlg), NULL, KeyHookDlgProc, (LPARAM)hInstance);

  00028	e3a02005	 mov         r2, #5
  0002c	e3a01067	 mov         r1, #0x67
  00030	e1a00004	 mov         r0, r4
  00034	eb000000	 bl          FindResourceW
  00038	e1a01000	 mov         r1, r0
  0003c	e1a00004	 mov         r0, r4
  00040	eb000000	 bl          LoadResource
  00044	e59f3050	 ldr         r3, [pc, #0x50]
  00048	e1a01000	 mov         r1, r0
  0004c	e1a00004	 mov         r0, r4
  00050	e3a02000	 mov         r2, #0
  00054	e58d4000	 str         r4, [sp]
  00058	eb000000	 bl          CreateDialogIndirectParamW

; 29   :        
; 30   : 	while (GetMessage(&msg, NULL, 0, 0)) 

  0005c	ea000003	 b           |$LN11@WinMain|
  00060		 |$LL2@WinMain|

; 31   : 	{
; 32   : 		TranslateMessage(&msg);

  00060	e28d0004	 add         r0, sp, #4
  00064	eb000000	 bl          TranslateMessage

; 33   : 		DispatchMessage(&msg);

  00068	e28d0004	 add         r0, sp, #4
  0006c	eb000000	 bl          DispatchMessageW
  00070		 |$LN11@WinMain|
  00070	e3a03000	 mov         r3, #0
  00074	e3a02000	 mov         r2, #0
  00078	e3a01000	 mov         r1, #0
  0007c	e28d0004	 add         r0, sp, #4
  00080	eb000000	 bl          GetMessageW
  00084	e3500000	 cmp         r0, #0
  00088	1afffff4	 bne         |$LL2@WinMain|
  0008c		 |$LN1@WinMain|

; 34   : 	}
; 35   : 	
; 36   : 	return 0;

  0008c	e3a00000	 mov         r0, #0

; 37   : }

  00090	e28dd020	 add         sp, sp, #0x20
  00094	e8bd4010	 ldmia       sp!, {r4, lr}
  00098	e12fff1e	 bx          lr
  0009c		 |$LN15@WinMain|
  0009c		 |$LN16@WinMain|
  0009c	00000000	 DCD         |?KeyHookDlgProc@@YAHPAUHWND__@@IIJ@Z|
  000a0		 |$LN17@WinMain|
  000a0	00000000	 DCD         |??_C@_1DC@OLKPMOAM@?$AA?$CK?$AA?$CK?$AA?$CK?$AA?5?$AAS?$AAt?$AAa?$AAr?$AAt?$AA?5?$AAK?$AAe?$AAy?$AA?5?$AAH?$AAo?$AAo?$AAk?$AA?5?$AA?$CK?$AA?$CK?$AA?$CK?$AA?$AN?$AA?6?$AA?$AA@|
  000a4		 |$LN18@WinMain|
  000a4	00000000	 DCD         |??_C@_1BG@KBNMNJAO@?$AAF?$AAu?$AAn?$AAK?$AAe?$AAy?$AAH?$AAo?$AAo?$AAk?$AA?$AA@|
  000a8		 |$M32037|

			 ENDP  ; |WinMain|

	END
