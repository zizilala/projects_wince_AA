; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\platform\Z2170P\src\APP\common\driverreg.cxx
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?RegisterDriver@@YAKPAG@Z|		; RegisterDriver
	EXPORT	|??_C@_1CE@OBOJKJOP@?$AAD?$AAl?$AAl?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAD?$AAr?$AAi?$AAv?$AAe?$AAr?$AA?$AA@| [ DATA ] ; `string'
	IMPORT	|FreeLibrary|
	IMPORT	|GetProcAddressW|
	IMPORT	|GetLastError|
	IMPORT	|LoadLibraryW|
; File c:\wince600\platform\z2170p\src\app\common\driverreg.cxx

  00000			 AREA	 |.pdata|, PDATA
|$T32331| DCD	|$LN8@RegisterDr|
	DCD	0x40001601

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CE@OBOJKJOP@?$AAD?$AAl?$AAl?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAD?$AAr?$AAi?$AAv?$AAe?$AAr?$AA?$AA@| DCB "D"
	DCB	0x0, "l", 0x0, "l", 0x0, "R", 0x0, "e", 0x0, "g", 0x0, "i"
	DCB	0x0, "s", 0x0, "t", 0x0, "e", 0x0, "r", 0x0, "D", 0x0, "r"
	DCB	0x0, "i", 0x0, "v", 0x0, "e", 0x0, "r", 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?RegisterDriver@@YAKPAG@Z| PROC	; RegisterDriver

; 26   : {

  00000		 |$LN8@RegisterDr|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004		 |$M32328|

; 27   :     DWORD dwRet;
; 28   :     pDllRegisterDriver fnDllRegisterDriver;
; 29   :     HMODULE hLib = (HMODULE)LoadLibrary(szDriver);

  00004	eb000000	 bl          LoadLibraryW
  00008	e1a05000	 mov         r5, r0

; 30   :     if (hLib == INVALID_HANDLE_VALUE)

  0000c	e3750001	 cmn         r5, #1
  00010	1a000002	 bne         |$LN3@RegisterDr|

; 31   :         {
; 32   :         dwRet = GetLastError();

  00014	eb000000	 bl          GetLastError
  00018	e1a04000	 mov         r4, r0
  0001c	ea000009	 b           |$cleanUp$32302|
  00020		 |$LN3@RegisterDr|

; 33   :         goto cleanUp;
; 34   :         }
; 35   : 
; 36   :     fnDllRegisterDriver = (pDllRegisterDriver)GetProcAddress(hLib, L"DllRegisterDriver");

  00020	e59f102c	 ldr         r1, [pc, #0x2C]
  00024	e1a00005	 mov         r0, r5
  00028	eb000000	 bl          GetProcAddressW
  0002c	e3500000	 cmp         r0, #0

; 37   :     if (fnDllRegisterDriver != NULL)
; 38   :         {
; 39   :         fnDllRegisterDriver();

  00030	11a0e00f	 movne       lr, pc
  00034	112fff10	 bxne        r0

; 40   :         }
; 41   : 
; 42   :     dwRet = GetLastError();

  00038	eb000000	 bl          GetLastError
  0003c	e1a04000	 mov         r4, r0

; 43   :     FreeLibrary(hLib);

  00040	e1a00005	 mov         r0, r5
  00044	eb000000	 bl          FreeLibrary
  00048		 |$cleanUp$32302|

; 44   : 
; 45   : cleanUp:
; 46   :     return dwRet;
; 47   : }

  00048	e1a00004	 mov         r0, r4
  0004c	e8bd4030	 ldmia       sp!, {r4, r5, lr}
  00050	e12fff1e	 bx          lr
  00054		 |$LN9@RegisterDr|
  00054		 |$LN10@RegisterDr|
  00054	00000000	 DCD         |??_C@_1CE@OBOJKJOP@?$AAD?$AAl?$AAl?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAD?$AAr?$AAi?$AAv?$AAe?$AAr?$AA?$AA@|
  00058		 |$M32329|

			 ENDP  ; |?RegisterDriver@@YAKPAG@Z|, RegisterDriver

	END
