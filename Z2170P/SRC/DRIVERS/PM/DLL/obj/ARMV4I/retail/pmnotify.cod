; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\Z2170P\SRC\DRIVERS\PM\DLL\pmnotify.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|__$ArrayPad$| [ DATA ]
	IMPORT	|CeLogData|
	IMPORT	|StringCchLengthW|
	IMPORT	|StringCchVPrintfW|
	IMPORT	|__GSHandlerCheck|
	IMPORT	|__security_cookie|
	IMPORT	|__security_check_cookie|
; File c:\wince600\public\common\sdk\inc\celog.h

  00000			 AREA	 |.pdata|, PDATA
|$T33667| DCD	|$LN7@CeLogMsg|
	DCD	0xc0002a04

  00000			 AREA	 |.xdata|, DATA
|$T33663| DCD	0xffffffe0
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__GSHandlerCheck|
  00004	00000000	 DCD         |$T33663|

  00008		 |CeLogMsg| PROC

; 1015 : {

  00008		 |$LN7@CeLogMsg|
  00008	e1a0c00d	 mov         r12, sp
  0000c	e92d000f	 stmdb       sp!, {r0 - r3}
  00010	e92d5010	 stmdb       sp!, {r4, r12, lr}
  00014	e24dde22	 sub         sp, sp, #0x22, 28
  00018		 |$M33664|
  00018	e58d022c	 str         r0, [sp, #0x22C]
  0001c	e59f3088	 ldr         r3, [pc, #0x88]
  00020	e5933000	 ldr         r3, [r3]
  00024	e58d321c	 str         r3, [sp, #0x21C]

; 1016 :     va_list arglist;
; 1017 :     WCHAR   szTemp[MAX_PATH];
; 1018 :     size_t  cchLen;
; 1019 :     HRESULT hr;
; 1020 : 
; 1021 :     // Compose a single string using the input args
; 1022 :     va_start(arglist, szFormat);
; 1023 :     hr = StringCchVPrintfW(szTemp, MAX_PATH, szFormat, arglist);

  00028	e1a02000	 mov         r2, r0
  0002c	e28d0014	 add         r0, sp, #0x14
  00030	e28d3e23	 add         r3, sp, #0x23, 28
  00034	e3a01f41	 mov         r1, #0x41, 30
  00038	eb000000	 bl          StringCchVPrintfW
  0003c	e3500000	 cmp         r0, #0

; 1024 :     if (SUCCEEDED(hr)) {

  00040	4a000014	 bmi         |$LN1@CeLogMsg|

; 1025 :         hr = StringCchLengthW(szTemp, MAX_PATH, &cchLen);

  00044	e28d2010	 add         r2, sp, #0x10
  00048	e3a01f41	 mov         r1, #0x41, 30
  0004c	e28d0014	 add         r0, sp, #0x14
  00050	eb000000	 bl          StringCchLengthW
  00054	e3500000	 cmp         r0, #0

; 1026 :         if (SUCCEEDED(hr)) {

  00058	4a00000e	 bmi         |$LN1@CeLogMsg|

; 1027 :             CeLogData(TRUE, CELID_RAW_WCHAR, szTemp, (WORD)((cchLen + 1) * sizeof(WCHAR)),
; 1028 :                       0, CELZONE_ALWAYSON, 0, FALSE);

  0005c	e59d3010	 ldr         r3, [sp, #0x10]
  00060	e3a04101	 mov         r4, #1, 2
  00064	e3a0e000	 mov         lr, #0
  00068	e2833001	 add         r3, r3, #1
  0006c	e1a03083	 mov         r3, r3, lsl #1
  00070	e1a03803	 mov         r3, r3, lsl #16
  00074	e1a03823	 mov         r3, r3, lsr #16
  00078	e28d2014	 add         r2, sp, #0x14
  0007c	e3a0104a	 mov         r1, #0x4A
  00080	e3a00001	 mov         r0, #1
  00084	e58de00c	 str         lr, [sp, #0xC]
  00088	e58de008	 str         lr, [sp, #8]
  0008c	e58d4004	 str         r4, [sp, #4]
  00090	e58de000	 str         lr, [sp]
  00094	eb000000	 bl          CeLogData
  00098		 |$LN1@CeLogMsg|
  00098	e59d021c	 ldr         r0, [sp, #0x21C]
  0009c	eb000000	 bl          __security_check_cookie

; 1029 :         }
; 1030 :     }
; 1031 : }

  000a0	e28dde22	 add         sp, sp, #0x22, 28
  000a4	e89d6010	 ldmia       sp, {r4, sp, lr}
  000a8	e12fff1e	 bx          lr
  000ac		 |$LN8@CeLogMsg|
  000ac		 |$LN9@CeLogMsg|
  000ac	00000000	 DCD         |__security_cookie|
  000b0		 |$M33665|

			 ENDP  ; |CeLogMsg|

	EXPORT	|SendNotification|
	EXPORT	|??_C@_1GI@DENKDPBO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAW?$AAr?$AAi?$AAt?$AAe?$AAM?$AAs?$AAg?$AAQ?$AAu?$AAe?$AAu?$AAe?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1GI@KNKFKCIB@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAo?$AA?5?$AA0?$AAx?$AA?$CF?$AA0@| [ DATA ] ; `string'
	IMPORT	|GetLastError|
	IMPORT	|WriteMsgQueue|
	IMPORT	|dpCurSettings|
; File c:\wince600\platform\z2170p\src\drivers\pm\dll\pmnotify.cpp

  00000			 AREA	 |.pdata|, PDATA
|$T33684| DCD	|$LN10@SendNotifi|
	DCD	0x40002902

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1GI@DENKDPBO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAW?$AAr?$AAi?$AAt?$AAe?$AAM?$AAs?$AAg?$AAQ?$AAu?$AAe?$AAu?$AAe?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "W", 0x0, "r", 0x0, "i"
	DCB	0x0, "t", 0x0, "e", 0x0, "M", 0x0, "s", 0x0, "g", 0x0, "Q"
	DCB	0x0, "u", 0x0, "e", 0x0, "u", 0x0, "e", 0x0, "(", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x", 0x0, ","
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, ",", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%"
	DCB	0x0, "x", 0x0, ")", 0x0, " ", 0x0, "f", 0x0, "a", 0x0, "i"
	DCB	0x0, "l", 0x0, "e", 0x0, "d", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@| DCB "S"
	DCB	0x0, "e", 0x0, "n", 0x0, "d", 0x0, "N", 0x0, "o", 0x0, "t"
	DCB	0x0, "i", 0x0, "f", 0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t"
	DCB	0x0, "i", 0x0, "o", 0x0, "n", 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1GI@KNKFKCIB@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAo?$AA?5?$AA0?$AAx?$AA?$CF?$AA0@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "n"
	DCB	0x0, "d", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " ", 0x0, "n"
	DCB	0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i", 0x0, "c"
	DCB	0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, " "
	DCB	0x0, "t", 0x0, "o", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%"
	DCB	0x0, "0", 0x0, "8", 0x0, "x", 0x0, " ", 0x0, "(", 0x0, "o"
	DCB	0x0, "w", 0x0, "n", 0x0, "e", 0x0, "r", 0x0, " ", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x", 0x0, ")"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SendNotification| PROC

; 27   : {

  00000		 |$LN10@SendNotifi|
  00000	e92d40f0	 stmdb       sp!, {r4 - r7, lr}
  00004	e24dd008	 sub         sp, sp, #8
  00008		 |$M33681|
  00008	e1a06002	 mov         r6, r2
  0000c	e1a07001	 mov         r7, r1
  00010	e1a04000	 mov         r4, r0

; 28   : #ifndef SHIP_BUILD
; 29   :     SETFNAME(_T("SendNotification"));
; 30   : #endif
; 31   : 
; 32   :     PMLOGMSG(ZONE_NOTIFY, 
; 33   :         (_T("%s: sending notification to 0x%08x (owner 0x%08x)\r\n"),
; 34   :         pszFname, ppn, ppn->hOwner));

  00014	e59f5084	 ldr         r5, [pc, #0x84]
  00018	e5953440	 ldr         r3, [r5, #0x440]
  0001c	e3130c01	 tst         r3, #1, 24
  00020	15943008	 ldrne       r3, [r4, #8]
  00024	159f0070	 ldrne       r0, [pc, #0x70]
  00028	159f1068	 ldrne       r1, [pc, #0x68]
  0002c	11a02004	 movne       r2, r4
  00030	1b000000	 blne        CeLogMsg

; 35   :     if(!WriteMsgQueue(ppn->hMsgQ, ppb, dwLen, 0, 0)) {

  00034	e5940000	 ldr         r0, [r4]
  00038	e3a0e000	 mov         lr, #0
  0003c	e3a03000	 mov         r3, #0
  00040	e1a02006	 mov         r2, r6
  00044	e1a01007	 mov         r1, r7
  00048	e58de000	 str         lr, [sp]
  0004c	eb000000	 bl          WriteMsgQueue
  00050	e3500000	 cmp         r0, #0
  00054	1a00000b	 bne         |$LN6@SendNotifi|

; 36   :         PMLOGMSG(ZONE_WARN, (_T("%s: WriteMsgQueue(0x%08x, 0x%08x, 0x%x) failed %d\r\n"),
; 37   :             pszFname, ppn->hMsgQ, ppb, dwLen, GetLastError()));

  00058	e5953440	 ldr         r3, [r5, #0x440]
  0005c	e3130002	 tst         r3, #2
  00060	0a000008	 beq         |$LN6@SendNotifi|
  00064	eb000000	 bl          GetLastError
  00068	e5942000	 ldr         r2, [r4]
  0006c	e59f1024	 ldr         r1, [pc, #0x24]
  00070	e1a0e000	 mov         lr, r0
  00074	e59f0018	 ldr         r0, [pc, #0x18]
  00078	e1a03007	 mov         r3, r7
  0007c	e58de004	 str         lr, [sp, #4]
  00080	e58d6000	 str         r6, [sp]
  00084	eb000000	 bl          CeLogMsg
  00088		 |$LN6@SendNotifi|

; 38   :     }        
; 39   : }

  00088	e28dd008	 add         sp, sp, #8
  0008c	e8bd40f0	 ldmia       sp!, {r4 - r7, lr}
  00090	e12fff1e	 bx          lr
  00094		 |$LN11@SendNotifi|
  00094		 |$LN12@SendNotifi|
  00094	00000000	 DCD         |??_C@_1GI@DENKDPBO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAW?$AAr?$AAi?$AAt?$AAe?$AAM?$AAs?$AAg?$AAQ?$AAu?$AAe?$AAu?$AAe?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@|
  00098		 |$LN13@SendNotifi|
  00098	00000000	 DCD         |??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@|
  0009c		 |$LN14@SendNotifi|
  0009c	00000000	 DCD         |??_C@_1GI@KNKFKCIB@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAo?$AA?5?$AA0?$AAx?$AA?$CF?$AA0@|
  000a0		 |$LN15@SendNotifi|
  000a0	00000000	 DCD         |dpCurSettings|
  000a4		 |$M33682|

			 ENDP  ; |SendNotification|

	EXPORT	|GenerateNotifications|
	EXPORT	|??_C@_1FC@IHBDDNIO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAo?$AAn?$AAe?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1FO@BFJEGKNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn@| [ DATA ] ; `string'
	IMPORT	|PmUnlock|
	IMPORT	|gpPowerNotifications|
	IMPORT	|PmLock|

  00000			 AREA	 |.pdata|, PDATA
|$T33706| DCD	|$LN17@GenerateNo|
	DCD	0x40002a01

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FC@IHBDDNIO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAo?$AAn?$AAe?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "d", 0x0, "o", 0x0, "n"
	DCB	0x0, "e", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "n", 0x0, "d"
	DCB	0x0, "i", 0x0, "n", 0x0, "g", 0x0, " ", 0x0, "t", 0x0, "y"
	DCB	0x0, "p", 0x0, "e", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, " "
	DCB	0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, "s", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "G"
	DCB	0x0, "e", 0x0, "n", 0x0, "e", 0x0, "r", 0x0, "a", 0x0, "t"
	DCB	0x0, "e", 0x0, "N", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f"
	DCB	0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o"
	DCB	0x0, "n", 0x0, "s", 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FO@BFJEGKNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "n"
	DCB	0x0, "d", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " ", 0x0, "t"
	DCB	0x0, "y", 0x0, "p", 0x0, "e", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, " ", 0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f"
	DCB	0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o"
	DCB	0x0, "n", 0x0, "s", 0x0, " ", 0x0, "(", 0x0, "%", 0x0, "d"
	DCB	0x0, " ", 0x0, "b", 0x0, "y", 0x0, "t", 0x0, "e", 0x0, "s"
	DCB	0x0, ")", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |GenerateNotifications| PROC

; 44   : {

  00000		 |$LN17@GenerateNo|
  00000	e92d40f0	 stmdb       sp!, {r4 - r7, lr}
  00004		 |$M33703|
  00004	e1a05000	 mov         r5, r0

; 45   :     PPOWER_NOTIFICATION ppn;
; 46   :     DWORD dwLen;
; 47   : 
; 48   : #ifndef SHIP_BUILD
; 49   :     SETFNAME(_T("GenerateNotifications"));
; 50   : #endif
; 51   : 
; 52   :     PREFAST_DEBUGCHK(ppb != NULL);
; 53   : 
; 54   :     // Calculate the amount of data to send, since these are variable length
; 55   :     // messages.  Always send at least sizeof(POWER_BROADCAST) bytes so that
; 56   :     // the receiver doesn't have to worry about structure alignment and size
; 57   :     // issues when they receive the message.
; 58   :     dwLen = ppb->Length + (3 * sizeof(DWORD));

  00008	e5953008	 ldr         r3, [r5, #8]

; 59   :     if(dwLen < sizeof(POWER_BROADCAST)) {
; 60   :         dwLen = sizeof(POWER_BROADCAST);
; 61   :     }
; 62   : 
; 63   :     PMLOGMSG(ZONE_NOTIFY, (_T("%s: sending type %d notifications (%d bytes)\r\n"),
; 64   :         pszFname, ppb->Message, dwLen));

  0000c	e59f7090	 ldr         r7, [pc, #0x90]
  00010	e283400c	 add         r4, r3, #0xC
  00014	e5973440	 ldr         r3, [r7, #0x440]
  00018	e3540010	 cmp         r4, #0x10
  0001c	33a04010	 movcc       r4, #0x10
  00020	e3130c01	 tst         r3, #1, 24
  00024	15952000	 ldrne       r2, [r5]
  00028	159f0070	 ldrne       r0, [pc, #0x70]
  0002c	159f1060	 ldrne       r1, [pc, #0x60]
  00030	11a03004	 movne       r3, r4
  00034	1b000000	 blne        CeLogMsg

; 65   : 
; 66   :     PMLOCK();

  00038	eb000000	 bl          PmLock

; 67   :     for(ppn = gpPowerNotifications; ppn != NULL; ppn = ppn->pNext) {

  0003c	e59f3058	 ldr         r3, [pc, #0x58]
  00040	e5933000	 ldr         r3, [r3]
  00044	ea000007	 b           |$LN14@GenerateNo|
  00048		 |$LL4@GenerateNo|

; 68   :         // is this a message type for which the client has registered?
; 69   :         if((ppn->dwFlags & ppb->Message) != 0) {

  00048	e5962004	 ldr         r2, [r6, #4]
  0004c	e5953000	 ldr         r3, [r5]
  00050	e1120003	 tst         r2, r3

; 70   :             // yes, send the message
; 71   :             SendNotification(ppn, ppb, dwLen);

  00054	11a02004	 movne       r2, r4
  00058	11a01005	 movne       r1, r5
  0005c	11a00006	 movne       r0, r6
  00060	1b000000	 blne        SendNotification
  00064	e596300c	 ldr         r3, [r6, #0xC]
  00068		 |$LN14@GenerateNo|
  00068	e1b06003	 movs        r6, r3
  0006c	1afffff5	 bne         |$LL4@GenerateNo|

; 72   :         }
; 73   :     }
; 74   :     PMUNLOCK();

  00070	eb000000	 bl          PmUnlock

; 75   : 
; 76   :     PMLOGMSG(ZONE_NOTIFY, (_T("%s: done sending type %d notifications\r\n"),
; 77   :         pszFname, ppb->Message));

  00074	e5973440	 ldr         r3, [r7, #0x440]
  00078	e3130c01	 tst         r3, #1, 24
  0007c	15952000	 ldrne       r2, [r5]
  00080	159f0010	 ldrne       r0, [pc, #0x10]
  00084	159f1008	 ldrne       r1, [pc, #8]
  00088	1b000000	 blne        CeLogMsg

; 78   : }

  0008c	e8bd40f0	 ldmia       sp!, {r4 - r7, lr}
  00090	e12fff1e	 bx          lr
  00094		 |$LN18@GenerateNo|
  00094		 |$LN19@GenerateNo|
  00094	00000000	 DCD         |??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00098		 |$LN20@GenerateNo|
  00098	00000000	 DCD         |??_C@_1FC@IHBDDNIO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAo?$AAn?$AAe?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc@|
  0009c		 |$LN21@GenerateNo|
  0009c	00000000	 DCD         |gpPowerNotifications|
  000a0		 |$LN22@GenerateNo|
  000a0	00000000	 DCD         |??_C@_1FO@BFJEGKNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn@|
  000a4		 |$LN23@GenerateNo|
  000a4	00000000	 DCD         |dpCurSettings|
  000a8		 |$M33704|

			 ENDP  ; |GenerateNotifications|

	EXPORT	|DeleteProcessNotifications|
	EXPORT	|??_C@_1DG@KHNJBFOM@?$AAD?$AAe?$AAl?$AAe?$AAt?$AAe?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1EG@OGLFPMCD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAe?$AAl?$AAe?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| [ DATA ] ; `string'
	IMPORT	|PowerNotificationRemList|

  00000			 AREA	 |.pdata|, PDATA
|$T33730| DCD	|$LN20@DeleteProc|
	DCD	0x40002201

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DG@KHNJBFOM@?$AAD?$AAe?$AAl?$AAe?$AAt?$AAe?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "D"
	DCB	0x0, "e", 0x0, "l", 0x0, "e", 0x0, "t", 0x0, "e", 0x0, "P"
	DCB	0x0, "r", 0x0, "o", 0x0, "c", 0x0, "e", 0x0, "s", 0x0, "s"
	DCB	0x0, "N", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, "s", 0x0, 0x0, 0x0			; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1EG@OGLFPMCD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAe?$AAl?$AAe?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "d", 0x0, "e", 0x0, "l"
	DCB	0x0, "e", 0x0, "t", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " "
	DCB	0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |DeleteProcessNotifications| PROC

; 84   : {

  00000		 |$LN20@DeleteProc|
  00000	e92d41f0	 stmdb       sp!, {r4 - r8, lr}
  00004		 |$M33727|
  00004	e1a07000	 mov         r7, r0

; 85   :     BOOL fDone = FALSE;

  00008	e3a05000	 mov         r5, #0

; 86   : 
; 87   : #ifndef SHIP_BUILD
; 88   :     SETFNAME(_T("DeleteProcessNotifications"));
; 89   : #endif
; 90   : 
; 91   :     PMLOCK();

  0000c	eb000000	 bl          PmLock
  00010	e59f806c	 ldr         r8, [pc, #0x6C]
  00014	e59f6064	 ldr         r6, [pc, #0x64]
  00018		 |$LL7@DeleteProc|
  00018	e5963000	 ldr         r3, [r6]
  0001c	ea000003	 b           |$LN17@DeleteProc|
  00020		 |$LL5@DeleteProc|

; 97   :         PPOWER_NOTIFICATION ppn;
; 98   :         for(ppn = gpPowerNotifications; ppn != NULL; ppn = ppn->pNext) {
; 99   :             if(ppn->hOwner == hProcess) {

  00020	e5943008	 ldr         r3, [r4, #8]
  00024	e1530007	 cmp         r3, r7
  00028	0a000008	 beq         |$LN14@DeleteProc|
  0002c	e594300c	 ldr         r3, [r4, #0xC]
  00030		 |$LN17@DeleteProc|
  00030	e1b04003	 movs        r4, r3
  00034	1afffff9	 bne         |$LL5@DeleteProc|

; 109  :             // yes, no need to re-iterate
; 110  :             fDone = TRUE;

  00038	e3a05001	 mov         r5, #1
  0003c		 |$LN1@DeleteProc|

; 92   : 
; 93   :     // remove all notifications belonging to this process.  If we
; 94   :     // remove one from the list, start again -- we will eventually run
; 95   :     // out of notifications for this process.
; 96   :     while(!fDone) {

  0003c	e3550000	 cmp         r5, #0
  00040	0afffff4	 beq         |$LL7@DeleteProc|

; 111  :         }
; 112  :     }
; 113  : 
; 114  :     PMUNLOCK();

  00044	eb000000	 bl          PmUnlock

; 115  : }

  00048	e8bd41f0	 ldmia       sp!, {r4 - r8, lr}
  0004c	e12fff1e	 bx          lr
  00050		 |$LN14@DeleteProc|

; 100  :                 PMLOGMSG(ZONE_NOTIFY, (_T("%s: deleting notification 0x%08x\r\n"),
; 101  :                     pszFname, ppn));

  00050	e5983440	 ldr         r3, [r8, #0x440]
  00054	e3130c01	 tst         r3, #1, 24
  00058	159f101c	 ldrne       r1, [pc, #0x1C]
  0005c	159f0014	 ldrne       r0, [pc, #0x14]
  00060	11a02004	 movne       r2, r4
  00064	1b000000	 blne        CeLogMsg

; 102  :                 PowerNotificationRemList(&gpPowerNotifications, ppn);

  00068	e1a01004	 mov         r1, r4
  0006c	e1a00006	 mov         r0, r6
  00070	eb000000	 bl          PowerNotificationRemList

; 103  :                 break;
; 104  :             }
; 105  :         }
; 106  : 
; 107  :         // did we get through the whole list?
; 108  :         if(ppn == NULL) {

  00074	eafffff0	 b           |$LN1@DeleteProc|
  00078		 |$LN21@DeleteProc|
  00078		 |$LN22@DeleteProc|
  00078	00000000	 DCD         |??_C@_1EG@OGLFPMCD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAe?$AAl?$AAe?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@|
  0007c		 |$LN23@DeleteProc|
  0007c	00000000	 DCD         |??_C@_1DG@KHNJBFOM@?$AAD?$AAe?$AAl?$AAe?$AAt?$AAe?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00080		 |$LN24@DeleteProc|
  00080	00000000	 DCD         |gpPowerNotifications|
  00084		 |$LN25@DeleteProc|
  00084	00000000	 DCD         |dpCurSettings|
  00088		 |$M33728|

			 ENDP  ; |DeleteProcessNotifications|

	EXPORT	|PmRequestPowerNotifications|
	EXPORT	|??_C@_1EE@LLHHOOMD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1GG@MEFCMPGO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA0@| [ DATA ] ; `string'
	IMPORT	|SetLastError|
	IMPORT	|PlatformSendInitialNotifications|
	IMPORT	|PowerNotificationAddList|
	IMPORT	|PowerNotificationCreate|
	IMPORT	|GetCallerProcess|

  00000			 AREA	 |.pdata|, PDATA
|$T33756| DCD	|$LN16@PmRequestP|
	DCD	0x40003f01

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1EE@LLHHOOMD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "r", 0x0, "e", 0x0, "t"
	DCB	0x0, "u", 0x0, "r", 0x0, "n", 0x0, "i", 0x0, "n", 0x0, "g"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, ",", 0x0, " ", 0x0, "s", 0x0, "t", 0x0, "a"
	DCB	0x0, "t", 0x0, "u", 0x0, "s", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "P"
	DCB	0x0, "m", 0x0, "R", 0x0, "e", 0x0, "q", 0x0, "u", 0x0, "e"
	DCB	0x0, "s", 0x0, "t", 0x0, "P", 0x0, "o", 0x0, "w", 0x0, "e"
	DCB	0x0, "r", 0x0, "N", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f"
	DCB	0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o"
	DCB	0x0, "n", 0x0, "s", 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1GG@MEFCMPGO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA0@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "c", 0x0, "r", 0x0, "e"
	DCB	0x0, "a", 0x0, "t", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " "
	DCB	0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, " ", 0x0, "t", 0x0, "y", 0x0, "p", 0x0, "e", 0x0, " "
	DCB	0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x"
	DCB	0x0, " ", 0x0, "f", 0x0, "o", 0x0, "r", 0x0, " ", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |PmRequestPowerNotifications| PROC

; 126  : {

  00000		 |$LN16@PmRequestP|
  00000	e92d43f0	 stmdb       sp!, {r4 - r9, lr}
  00004		 |$M33753|
  00004	e1a08001	 mov         r8, r1
  00008	e1a07000	 mov         r7, r0

; 127  :     HANDLE hOwner = GetCallerProcess();

  0000c	eb000000	 bl          GetCallerProcess

; 128  :     DWORD dwStatus = ERROR_SUCCESS;
; 129  :     PPOWER_NOTIFICATION ppn = NULL;
; 130  : 
; 131  : #ifndef SHIP_BUILD
; 132  :     SETFNAME(_T("PmRequestPowerNotifications"));
; 133  : #endif
; 134  : 
; 135  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API, 
; 136  :         (_T("%s: creating notification type 0x%08x for 0x%08x\r\n"),
; 137  :         pszFname, dwFlags, hOwner));

  00010	e59f60e0	 ldr         r6, [pc, #0xE0]
  00014	e1a09000	 mov         r9, r0
  00018	e3a04000	 mov         r4, #0
  0001c	e5963440	 ldr         r3, [r6, #0x440]
  00020	e3a05000	 mov         r5, #0
  00024	e3130c01	 tst         r3, #1, 24
  00028	1a000001	 bne         |$LN7@PmRequestP|
  0002c	e3130b02	 tst         r3, #2, 22
  00030	0a000005	 beq         |$LN8@PmRequestP|
  00034		 |$LN7@PmRequestP|
  00034	e59f00b8	 ldr         r0, [pc, #0xB8]
  00038	e59f10a8	 ldr         r1, [pc, #0xA8]
  0003c	e1a03009	 mov         r3, r9
  00040	e1a02008	 mov         r2, r8
  00044	eb000000	 bl          CeLogMsg
  00048	e5963440	 ldr         r3, [r6, #0x440]
  0004c		 |$LN8@PmRequestP|

; 138  : 
; 139  :     // check parameters
; 140  :     if(hMsgQ == NULL) {

  0004c	e3570000	 cmp         r7, #0

; 141  :         dwStatus = ERROR_INVALID_PARAMETER;

  00050	03a04057	 moveq       r4, #0x57
  00054	0a000011	 beq         |$LN1@PmRequestP|

; 142  :     }
; 143  : 
; 144  :     // create the structure if parameters are all right
; 145  :     if(dwStatus == ERROR_SUCCESS) {
; 146  :         ppn = PowerNotificationCreate(hMsgQ, hOwner);

  00058	e1a01009	 mov         r1, r9
  0005c	e1a00007	 mov         r0, r7
  00060	eb000000	 bl          PowerNotificationCreate
  00064	e1b05000	 movs        r5, r0

; 147  :         if(ppn != NULL) {

  00068	0a000009	 beq         |$LN2@PmRequestP|

; 148  :             ppn->dwFlags = dwFlags;

  0006c	e5858004	 str         r8, [r5, #4]

; 149  : 
; 150  :             PMLOCK();

  00070	eb000000	 bl          PmLock

; 151  :             // add the notification structure to the list
; 152  :             PowerNotificationAddList(&gpPowerNotifications, ppn);

  00074	e59f0074	 ldr         r0, [pc, #0x74]
  00078	e1a01005	 mov         r1, r5
  0007c	eb000000	 bl          PowerNotificationAddList

; 153  : 
; 154  :             // if the notification requires any platform-specific action,
; 155  :             // the platform can do it now
; 156  :             PlatformSendInitialNotifications(ppn, dwFlags);

  00080	e1a01008	 mov         r1, r8
  00084	e1a00005	 mov         r0, r5
  00088	eb000000	 bl          PlatformSendInitialNotifications

; 157  :             PMUNLOCK();

  0008c	eb000000	 bl          PmUnlock

; 158  :         } else {

  00090	ea000001	 b           |$LN13@PmRequestP|
  00094		 |$LN2@PmRequestP|

; 159  :             dwStatus = GetLastError();  // set by whatever failed in PowerNotificationCreate()

  00094	eb000000	 bl          GetLastError
  00098	e1a04000	 mov         r4, r0
  0009c		 |$LN13@PmRequestP|
  0009c	e5963440	 ldr         r3, [r6, #0x440]
  000a0		 |$LN1@PmRequestP|

; 160  :             DEBUGCHK(dwStatus != ERROR_SUCCESS);
; 161  :         }
; 162  :     }
; 163  : 
; 164  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API || (dwStatus != ERROR_SUCCESS && ZONE_WARN),
; 165  :         (_T("%s: returning 0x%08x, status %d\r\n"), pszFname,
; 166  :         ppn, dwStatus));

  000a0	e3130c01	 tst         r3, #1, 24
  000a4	1a000005	 bne         |$LN9@PmRequestP|
  000a8	e3130b02	 tst         r3, #2, 22
  000ac	1a000003	 bne         |$LN9@PmRequestP|
  000b0	e3540000	 cmp         r4, #0
  000b4	0a000006	 beq         |$LN11@PmRequestP|
  000b8	e3130002	 tst         r3, #2
  000bc	0a000004	 beq         |$LN11@PmRequestP|
  000c0		 |$LN9@PmRequestP|
  000c0	e59f0024	 ldr         r0, [pc, #0x24]
  000c4	e59f101c	 ldr         r1, [pc, #0x1C]
  000c8	e1a03004	 mov         r3, r4
  000cc	e1a02005	 mov         r2, r5
  000d0	eb000000	 bl          CeLogMsg
  000d4		 |$LN11@PmRequestP|

; 167  :     SetLastError(dwStatus);

  000d4	e1a00004	 mov         r0, r4
  000d8	eb000000	 bl          SetLastError

; 168  :     return ppn;
; 169  : }

  000dc	e1a00005	 mov         r0, r5
  000e0	e8bd43f0	 ldmia       sp!, {r4 - r9, lr}
  000e4	e12fff1e	 bx          lr
  000e8		 |$LN17@PmRequestP|
  000e8		 |$LN18@PmRequestP|
  000e8	00000000	 DCD         |??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  000ec		 |$LN19@PmRequestP|
  000ec	00000000	 DCD         |??_C@_1EE@LLHHOOMD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN@|
  000f0		 |$LN20@PmRequestP|
  000f0	00000000	 DCD         |gpPowerNotifications|
  000f4		 |$LN21@PmRequestP|
  000f4	00000000	 DCD         |??_C@_1GG@MEFCMPGO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA0@|
  000f8		 |$LN22@PmRequestP|
  000f8	00000000	 DCD         |dpCurSettings|
  000fc		 |$M33754|

			 ENDP  ; |PmRequestPowerNotifications|

	EXPORT	|PmStopPowerNotifications|
	EXPORT	|??_C@_1DE@EDKKHCHC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CO@IGCJGAON@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAh?$AAa?$AAn?$AAd?$AAl?$AAe?$AA?5?$AAi?$AAs?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'

  00000			 AREA	 |.pdata|, PDATA
|$T33778| DCD	|$LN13@PmStopPowe|
	DCD	0x40002d01

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DE@EDKKHCHC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "r", 0x0, "e", 0x0, "t"
	DCB	0x0, "u", 0x0, "r", 0x0, "n", 0x0, "i", 0x0, "n", 0x0, "g"
	DCB	0x0, " ", 0x0, "s", 0x0, "t", 0x0, "a", 0x0, "t", 0x0, "u"
	DCB	0x0, "s", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, 0xd, 0x0, 0xa
	DCB	0x0, 0x0, 0x0				; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "P"
	DCB	0x0, "m", 0x0, "S", 0x0, "t", 0x0, "o", 0x0, "p", 0x0, "P"
	DCB	0x0, "o", 0x0, "w", 0x0, "e", 0x0, "r", 0x0, "N", 0x0, "o"
	DCB	0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i", 0x0, "c", 0x0, "a"
	DCB	0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, "s", 0x0, 0x0
	DCB	0x0					; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CO@IGCJGAON@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAh?$AAa?$AAn?$AAd?$AAl?$AAe?$AA?5?$AAi?$AAs?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "h", 0x0, "a", 0x0, "n"
	DCB	0x0, "d", 0x0, "l", 0x0, "e", 0x0, " ", 0x0, "i", 0x0, "s"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |PmStopPowerNotifications| PROC

; 178  : {

  00000		 |$LN13@PmStopPowe|
  00000	e92d4070	 stmdb       sp!, {r4 - r6, lr}
  00004		 |$M33775|
  00004	e1a05000	 mov         r5, r0

; 179  :     DWORD dwStatus = ERROR_INVALID_PARAMETER;
; 180  :     PPOWER_NOTIFICATION ppn = (PPOWER_NOTIFICATION) h;
; 181  : 
; 182  : #ifndef SHIP_BUILD
; 183  :     SETFNAME(_T("PmStopPowerNotifications"));
; 184  : #endif
; 185  : 
; 186  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API, (_T("%s: handle is 0x%08x\r\n"), pszFname, h));

  00008	e59f60a0	 ldr         r6, [pc, #0xA0]
  0000c	e3a04057	 mov         r4, #0x57
  00010	e5963440	 ldr         r3, [r6, #0x440]
  00014	e3130c01	 tst         r3, #1, 24
  00018	1a000001	 bne         |$LN6@PmStopPowe|
  0001c	e3130b02	 tst         r3, #2, 22
  00020	0a000004	 beq         |$LN7@PmStopPowe|
  00024		 |$LN6@PmStopPowe|
  00024	e59f0080	 ldr         r0, [pc, #0x80]
  00028	e59f1070	 ldr         r1, [pc, #0x70]
  0002c	e1a02005	 mov         r2, r5
  00030	eb000000	 bl          CeLogMsg
  00034	e5963440	 ldr         r3, [r6, #0x440]
  00038		 |$LN7@PmStopPowe|

; 187  :     if(ppn != NULL) {

  00038	e3550000	 cmp         r5, #0
  0003c	0a000008	 beq         |$LN3@PmStopPowe|

; 188  :         PMLOCK();

  00040	eb000000	 bl          PmLock

; 189  :         BOOL fFound = PowerNotificationRemList(&gpPowerNotifications, ppn);

  00044	e59f005c	 ldr         r0, [pc, #0x5C]
  00048	e1a01005	 mov         r1, r5
  0004c	eb000000	 bl          PowerNotificationRemList
  00050	e3500000	 cmp         r0, #0

; 190  :         if(fFound) {
; 191  :             dwStatus = ERROR_SUCCESS;

  00054	13a04000	 movne       r4, #0

; 192  :         } else {
; 193  :             dwStatus = ERROR_FILE_NOT_FOUND;

  00058	03a04002	 moveq       r4, #2

; 194  :         }
; 195  :         PMUNLOCK();

  0005c	eb000000	 bl          PmUnlock
  00060	e5963440	 ldr         r3, [r6, #0x440]
  00064		 |$LN3@PmStopPowe|

; 196  :     }
; 197  : 
; 198  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API || (dwStatus != ERROR_SUCCESS && ZONE_WARN),
; 199  :         (_T("%s: returning status %d\r\n"), pszFname, dwStatus));

  00064	e3130c01	 tst         r3, #1, 24
  00068	1a000005	 bne         |$LN8@PmStopPowe|
  0006c	e3130b02	 tst         r3, #2, 22
  00070	1a000003	 bne         |$LN8@PmStopPowe|
  00074	e3540000	 cmp         r4, #0
  00078	0a000005	 beq         |$LN10@PmStopPowe|
  0007c	e3130002	 tst         r3, #2
  00080	0a000003	 beq         |$LN10@PmStopPowe|
  00084		 |$LN8@PmStopPowe|
  00084	e59f0018	 ldr         r0, [pc, #0x18]
  00088	e59f1010	 ldr         r1, [pc, #0x10]
  0008c	e1a02004	 mov         r2, r4
  00090	eb000000	 bl          CeLogMsg
  00094		 |$LN10@PmStopPowe|

; 200  :     return dwStatus;
; 201  : }

  00094	e1a00004	 mov         r0, r4
  00098	e8bd4070	 ldmia       sp!, {r4 - r6, lr}
  0009c	e12fff1e	 bx          lr
  000a0		 |$LN14@PmStopPowe|
  000a0		 |$LN15@PmStopPowe|
  000a0	00000000	 DCD         |??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  000a4		 |$LN16@PmStopPowe|
  000a4	00000000	 DCD         |??_C@_1DE@EDKKHCHC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  000a8		 |$LN17@PmStopPowe|
  000a8	00000000	 DCD         |gpPowerNotifications|
  000ac		 |$LN18@PmStopPowe|
  000ac	00000000	 DCD         |??_C@_1CO@IGCJGAON@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAh?$AAa?$AAn?$AAd?$AAl?$AAe?$AA?5?$AAi?$AAs?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@|
  000b0		 |$LN19@PmStopPowe|
  000b0	00000000	 DCD         |dpCurSettings|
  000b4		 |$M33776|

			 ENDP  ; |PmStopPowerNotifications|

	END
