; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\COMMON_TI_V1\OMAP3530\MUSB\MUSBHCD\USB2COM\sync.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|PulseEvent|
	IMPORT	|EventModify|
; File c:\wince600\public\common\sdk\inc\kfuncs.h

  00000			 AREA	 |.pdata|, PDATA
|$T33846| DCD	|$LN5@PulseEvent|
	DCD	0x40000501
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |PulseEvent| PROC

; 211  : _inline BOOL PulseEvent(HANDLE h) {

  00000		 |$LN5@PulseEvent|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M33843|

; 212  : 	return EventModify(h,EVENT_PULSE);

  00004	e3a01001	 mov         r1, #1
  00008	eb000000	 bl          EventModify

; 213  : }

  0000c	e49de004	 ldr         lr, [sp], #4
  00010	e12fff1e	 bx          lr
  00014		 |$M33844|

			 ENDP  ; |PulseEvent|

	EXPORT	|ResetEvent|

  00000			 AREA	 |.pdata|, PDATA
|$T33856| DCD	|$LN5@ResetEvent|
	DCD	0x40000501
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |ResetEvent| PROC

; 223  : _inline BOOL ResetEvent(HANDLE h) {

  00000		 |$LN5@ResetEvent|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M33853|

; 224  : 	return EventModify(h,EVENT_RESET);

  00004	e3a01002	 mov         r1, #2
  00008	eb000000	 bl          EventModify

; 225  : }

  0000c	e49de004	 ldr         lr, [sp], #4
  00010	e12fff1e	 bx          lr
  00014		 |$M33854|

			 ENDP  ; |ResetEvent|

	EXPORT	|SetEvent|

  00000			 AREA	 |.pdata|, PDATA
|$T33866| DCD	|$LN5@SetEvent|
	DCD	0x40000501
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SetEvent| PROC

; 235  : _inline BOOL SetEvent(HANDLE h) {

  00000		 |$LN5@SetEvent|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M33863|

; 236  : 	return EventModify(h,EVENT_SET);

  00004	e3a01003	 mov         r1, #3
  00008	eb000000	 bl          EventModify

; 237  : }

  0000c	e49de004	 ldr         lr, [sp], #4
  00010	e12fff1e	 bx          lr
  00014		 |$M33864|

			 ENDP  ; |SetEvent|

	EXPORT	|GetCurrentThreadId|
	IMPORT	|__GetUserKData|

  00000			 AREA	 |.pdata|, PDATA
|$T33875| DCD	|$LN5@GetCurrent|
	DCD	0x40000501
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |GetCurrentThreadId| PROC

; 369  : _inline DWORD GetCurrentThreadId(void) {

  00000		 |$LN5@GetCurrent|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M33872|

; 370  :     return __GetUserKData (SYSHANDLE_OFFSET + (SH_CURTHREAD * sizeof(HANDLE)));

  00004	e3a00008	 mov         r0, #8
  00008	eb000000	 bl          __GetUserKData

; 371  : }

  0000c	e49de004	 ldr         lr, [sp], #4
  00010	e12fff1e	 bx          lr
  00014		 |$M33873|

			 ENDP  ; |GetCurrentThreadId|

	EXPORT	|?EnterCritSec_Ex@CritSec_Ex@@QAA?AW4e_CritSec_Status@@K@Z| ; CritSec_Ex::EnterCritSec_Ex
	IMPORT	|WaitForSingleObject|
	IMPORT	|LeaveCriticalSection|
	IMPORT	|EnterCriticalSection|
	IMPORT	|GetTickCount|

  00000			 AREA	 |.pdata|, PDATA
|$T33903| DCD	|$LN29@EnterCritS|
	DCD	0x40004901
; Function compile flags: /Ogspy
; File c:\wince600\platform\common\src\soc\common_ti_v1\omap3530\musb\musbhcd\usb2com\sync.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?EnterCritSec_Ex@CritSec_Ex@@QAA?AW4e_CritSec_Status@@K@Z| PROC ; CritSec_Ex::EnterCritSec_Ex

; 132  : {

  00000		 |$LN29@EnterCritS|
  00000	e92d4ff0	 stmdb       sp!, {r4 - r11, lr}
  00004		 |$M33900|
  00004	e1a08001	 mov         r8, r1
  00008	e1a04000	 mov         r4, r0

; 133  :     DWORD r;
; 134  :     ULONG tStart, tNow, tLeft;
; 135  :     CritSec_Status retval = CSS_SUCCESS;

  0000c	e3a05000	 mov         r5, #0

; 136  :     BOOL fWaiting;
; 137  :     DWORD me;
; 138  : 
; 139  :     tStart = GetTickCount();

  00010	eb000000	 bl          GetTickCount
  00014	e1a0a000	 mov         r10, r0

; 140  :     r = ! WAIT_TIMEOUT;  // anything other than WAIT_TIMEOUT will suffice
; 141  :     me = GetCurrentThreadId();

  00018	e3a00008	 mov         r0, #8
  0001c	e3a07000	 mov         r7, #0
  00020	eb000000	 bl          __GetUserKData

; 142  : 
; 143  :     // Help destruction proceed more quickly by preventing anyone new from using
; 144  :     // the IPC objects when we're pending destruction. Do this here for speed
; 145  :     // and again within the critical section for correctness.
; 146  :     if (m_fClosing)

  00024	e5943024	 ldr         r3, [r4, #0x24]
  00028	e1a09000	 mov         r9, r0
  0002c	e3530000	 cmp         r3, #0
  00030	0a000003	 beq         |$LN17@EnterCritS|

; 147  :         return CSS_DESTROYED;

  00034	e3a05001	 mov         r5, #1
  00038		 |$LN25@EnterCritS|

; 191  : 
; 192  :     return retval;
; 193  : }

  00038	e1a00005	 mov         r0, r5
  0003c	e8bd4ff0	 ldmia       sp!, {r4 - r11, lr}
  00040	e12fff1e	 bx          lr
  00044		 |$LN17@EnterCritS|

; 148  : 
; 149  :     EnterCriticalSection(&m_cs);

  00044	e2840010	 add         r0, r4, #0x10
  00048	eb000000	 bl          EnterCriticalSection
  0004c	e3a03c01	 mov         r3, #1, 24
  00050	e383b002	 orr         r11, r3, #2
  00054		 |$LN26@EnterCritS|

; 150  :     do {
; 151  :         fWaiting = FALSE;
; 152  : 
; 153  :         if (m_fClosing) {

  00054	e5943024	 ldr         r3, [r4, #0x24]
  00058	e3a02001	 mov         r2, #1
  0005c	e3a06000	 mov         r6, #0
  00060	e3530000	 cmp         r3, #0
  00064	0a000004	 beq         |$LN13@EnterCritS|

; 154  :             SetEvent(m_hev);

  00068	e594000c	 ldr         r0, [r4, #0xC]
  0006c	e3a01003	 mov         r1, #3
  00070	eb000000	 bl          EventModify

; 155  :             retval = CSS_DESTROYED;

  00074	e3a05001	 mov         r5, #1
  00078	ea000011	 b           |$LN6@EnterCritS|
  0007c		 |$LN13@EnterCritS|

; 156  :         }
; 157  :         else if (r == WAIT_TIMEOUT) {

  0007c	e157000b	 cmp         r7, r11

; 158  :             retval = CSS_TIMEOUT;

  00080	03a05002	 moveq       r5, #2
  00084	0a00000e	 beq         |$LN6@EnterCritS|

; 159  :         }
; 160  :         else if (m_hOwnerThread == 0) {

  00088	e5943000	 ldr         r3, [r4]
  0008c	e3530000	 cmp         r3, #0

; 161  :             m_hOwnerThread = me;

  00090	05849000	 streq       r9, [r4]

; 162  :             m_cOwnerReferences = 1;

  00094	05842004	 streq       r2, [r4, #4]

; 163  :             retval = CSS_SUCCESS;

  00098	03a05000	 moveq       r5, #0
  0009c	0a000008	 beq         |$LN6@EnterCritS|

; 164  :         }
; 165  :         else if (m_hOwnerThread == me) {

  000a0	e1530009	 cmp         r3, r9

; 166  :             ++m_cOwnerReferences;

  000a4	05943004	 ldreq       r3, [r4, #4]

; 167  :             retval = CSS_SUCCESS;

  000a8	03a05000	 moveq       r5, #0

; 168  :         }
; 169  :         else {
; 170  :             // Oh well, we've got to wait.
; 171  :             ++m_cWaitingThreads;
; 172  :             fWaiting = TRUE;

  000ac	13a06001	 movne       r6, #1
  000b0	02833001	 addeq       r3, r3, #1
  000b4	05843004	 streq       r3, [r4, #4]
  000b8	15943008	 ldrne       r3, [r4, #8]
  000bc	12833001	 addne       r3, r3, #1
  000c0	15843008	 strne       r3, [r4, #8]
  000c4		 |$LN6@EnterCritS|

; 173  :         }
; 174  :         LeaveCriticalSection(&m_cs);

  000c4	e2840010	 add         r0, r4, #0x10
  000c8	eb000000	 bl          LeaveCriticalSection

; 175  : 
; 176  :         if (fWaiting) {

  000cc	e3560000	 cmp         r6, #0
  000d0	0affffd8	 beq         |$LN25@EnterCritS|

; 177  :             if (ulTimeout != INFINITE) {

  000d4	e3780001	 cmn         r8, #1
  000d8	0a000007	 beq         |$LN4@EnterCritS|

; 178  :                 tNow = GetTickCount();

  000dc	eb000000	 bl          GetTickCount

; 179  :                 if (tNow - tStart < ulTimeout)

  000e0	e040300a	 sub         r3, r0, r10
  000e4	e1530008	 cmp         r3, r8

; 180  :                     tLeft = ulTimeout - (tNow - tStart);

  000e8	304a3000	 subcc       r3, r10, r0
  000ec	30831008	 addcc       r1, r3, r8
  000f0	3a000002	 bcc         |$LN1@EnterCritS|

; 181  :                 else
; 182  :                     tLeft = 0; // poll one more time

  000f4	e3a01000	 mov         r1, #0

; 183  :             } else {

  000f8	ea000000	 b           |$LN1@EnterCritS|
  000fc		 |$LN4@EnterCritS|

; 184  :                 tLeft = INFINITE;

  000fc	e3e01000	 mvn         r1, #0
  00100		 |$LN1@EnterCritS|

; 185  :             }
; 186  :             r = WaitForSingleObject(m_hev, tLeft);

  00100	e594000c	 ldr         r0, [r4, #0xC]
  00104	eb000000	 bl          WaitForSingleObject
  00108	e1a07000	 mov         r7, r0

; 187  :             EnterCriticalSection(&m_cs);

  0010c	e2840010	 add         r0, r4, #0x10
  00110	eb000000	 bl          EnterCriticalSection

; 188  :             --m_cWaitingThreads;

  00114	e5943008	 ldr         r3, [r4, #8]
  00118	e2433001	 sub         r3, r3, #1
  0011c	e5843008	 str         r3, [r4, #8]

; 189  :         }
; 190  :     } while (fWaiting);

  00120	eaffffcb	 b           |$LN26@EnterCritS|
  00124		 |$M33901|

			 ENDP  ; |?EnterCritSec_Ex@CritSec_Ex@@QAA?AW4e_CritSec_Status@@K@Z|, CritSec_Ex::EnterCritSec_Ex

	EXPORT	|?LeaveCritSec_Ex@CritSec_Ex@@QAAXXZ|	; CritSec_Ex::LeaveCritSec_Ex
; File c:\wince600\public\common\sdk\inc\kfuncs.h

  00000			 AREA	 |.pdata|, PDATA
|$T33915| DCD	|$LN8@LeaveCritS|
	DCD	0x40001001
; Function compile flags: /Ogspy
; File c:\wince600\platform\common\src\soc\common_ti_v1\omap3530\musb\musbhcd\usb2com\sync.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?LeaveCritSec_Ex@CritSec_Ex@@QAAXXZ| PROC ; CritSec_Ex::LeaveCritSec_Ex

; 196  : {

  00000		 |$LN8@LeaveCritS|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M33912|
  00004	e1a04000	 mov         r4, r0

; 197  : #ifdef POLITE // but not by default // default is to fail so the debugger knows you botched
; 198  :     if (m_fClosing && m_hOwnerThread == NULL)
; 199  :         // our caller violated protocol but we'll ignore it
; 200  :         return;
; 201  : #endif
; 202  :     ASSERT(m_hOwnerThread == GetCurrentThreadId());
; 203  :     
; 204  :     EnterCriticalSection(&m_cs);

  00008	e2840010	 add         r0, r4, #0x10
  0000c	eb000000	 bl          EnterCriticalSection

; 205  : 
; 206  :     // this would be symptomatic of a logic error in the caller
; 207  :     ASSERT(m_cOwnerReferences > 0);
; 208  : 
; 209  :     if (--m_cOwnerReferences == 0) {

  00010	e5943004	 ldr         r3, [r4, #4]
  00014	e2533001	 subs        r3, r3, #1

; 210  :         m_hOwnerThread = 0;
; 211  :         SetEvent(m_hev);

  00018	0594000c	 ldreq       r0, [r4, #0xC]
  0001c	e5843004	 str         r3, [r4, #4]
  00020	03a03000	 moveq       r3, #0
  00024	03a01003	 moveq       r1, #3
  00028	05843000	 streq       r3, [r4]
  0002c	0b000000	 bleq        EventModify

; 212  :     }
; 213  : 
; 214  :     LeaveCriticalSection(&m_cs);

  00030	e2840010	 add         r0, r4, #0x10
  00034	eb000000	 bl          LeaveCriticalSection

; 215  : }

  00038	e8bd4010	 ldmia       sp!, {r4, lr}
  0003c	e12fff1e	 bx          lr
  00040		 |$M33913|

			 ENDP  ; |?LeaveCritSec_Ex@CritSec_Ex@@QAAXXZ|, CritSec_Ex::LeaveCritSec_Ex

	EXPORT	|?Initialize@CritSec_Ex@@QAAXXZ|	; CritSec_Ex::Initialize

  00000			 AREA	 |.pdata|, PDATA
|$T33923| DCD	|$LN5@Initialize|
	DCD	0x40000d01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?Initialize@CritSec_Ex@@QAAXXZ| PROC	; CritSec_Ex::Initialize

; 228  : {

  00000		 |$LN5@Initialize|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M33920|
  00004	e1a04000	 mov         r4, r0

; 229  :     EnterCriticalSection(&m_cs);

  00008	e2840010	 add         r0, r4, #0x10
  0000c	eb000000	 bl          EnterCriticalSection

; 230  :     m_hOwnerThread = 0;

  00010	e3a03000	 mov         r3, #0

; 231  :     m_cOwnerReferences = 0;
; 232  :     m_cWaitingThreads = 0;
; 233  :     m_fClosing = FALSE;
; 234  :     LeaveCriticalSection(&m_cs);

  00014	e2840010	 add         r0, r4, #0x10
  00018	e5843000	 str         r3, [r4]
  0001c	e5843004	 str         r3, [r4, #4]
  00020	e5843008	 str         r3, [r4, #8]
  00024	e5843024	 str         r3, [r4, #0x24]
  00028	eb000000	 bl          LeaveCriticalSection

; 235  : }

  0002c	e8bd4010	 ldmia       sp!, {r4, lr}
  00030	e12fff1e	 bx          lr
  00034		 |$M33921|

			 ENDP  ; |?Initialize@CritSec_Ex@@QAAXXZ|, CritSec_Ex::Initialize

	EXPORT	|?PrepareDeleteCritSec_Ex@CritSec_Ex@@QAAXXZ| ; CritSec_Ex::PrepareDeleteCritSec_Ex
; File c:\wince600\public\common\sdk\inc\kfuncs.h

  00000			 AREA	 |.pdata|, PDATA
|$T33939| DCD	|$LN10@PrepareDel|
	DCD	0x40001401
; Function compile flags: /Ogspy
; File c:\wince600\platform\common\src\soc\common_ti_v1\omap3530\musb\musbhcd\usb2com\sync.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?PrepareDeleteCritSec_Ex@CritSec_Ex@@QAAXXZ| PROC ; CritSec_Ex::PrepareDeleteCritSec_Ex

; 238  : {

  00000		 |$LN10@PrepareDel|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004		 |$M33936|
  00004	e1a05000	 mov         r5, r0

; 239  :     DWORD me = GetCurrentThreadId();

  00008	e3a00008	 mov         r0, #8
  0000c	eb000000	 bl          __GetUserKData

; 240  :     
; 241  :     EnterCriticalSection(&m_cs);

  00010	e1a04000	 mov         r4, r0
  00014	e2850010	 add         r0, r5, #0x10
  00018	eb000000	 bl          EnterCriticalSection

; 242  :     m_fClosing = TRUE;
; 243  :     if (m_hOwnerThread == me) {

  0001c	e5953000	 ldr         r3, [r5]
  00020	e3a02001	 mov         r2, #1

; 244  :         // m_cOwnerReferences is >=1 but the caller had better not Leave after this...
; 245  :         m_hOwnerThread = 0;
; 246  :     }
; 247  :     LeaveCriticalSection(&m_cs);

  00024	e2850010	 add         r0, r5, #0x10
  00028	e1530004	 cmp         r3, r4
  0002c	03a03000	 moveq       r3, #0
  00030	05853000	 streq       r3, [r5]
  00034	e5852024	 str         r2, [r5, #0x24]
  00038	eb000000	 bl          LeaveCriticalSection

; 248  : 
; 249  :     // start waking up threads blocked on this critsec;
; 250  :     // each thread woken this way will set the event again.
; 251  :     SetEvent(m_hev);

  0003c	e595000c	 ldr         r0, [r5, #0xC]
  00040	e3a01003	 mov         r1, #3
  00044	eb000000	 bl          EventModify

; 252  : }

  00048	e8bd4030	 ldmia       sp!, {r4, r5, lr}
  0004c	e12fff1e	 bx          lr
  00050		 |$M33937|

			 ENDP  ; |?PrepareDeleteCritSec_Ex@CritSec_Ex@@QAAXXZ|, CritSec_Ex::PrepareDeleteCritSec_Ex

	EXPORT	|??1CritSec_Ex@@QAA@XZ|			; CritSec_Ex::~CritSec_Ex
	IMPORT	|DeleteCriticalSection|
	IMPORT	|CloseHandle|
; File c:\wince600\public\common\sdk\inc\kfuncs.h

  00000			 AREA	 |.pdata|, PDATA
|$T33961| DCD	|$LN17@CritSec_Ex|
	DCD	0x40001b01
; Function compile flags: /Ogspy
; File c:\wince600\platform\common\src\soc\common_ti_v1\omap3530\musb\musbhcd\usb2com\sync.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |??1CritSec_Ex@@QAA@XZ| PROC		; CritSec_Ex::~CritSec_Ex

; 255  : {

  00000		 |$LN17@CritSec_Ex|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004		 |$M33958|
  00004	e1a04000	 mov         r4, r0

; 256  :     BOOL bDone;
; 257  : 
; 258  :     // In case it wasn't already done:
; 259  :     PrepareDeleteCritSec_Ex();

  00008	eb000000	 bl          |?PrepareDeleteCritSec_Ex@CritSec_Ex@@QAAXXZ|

; 260  : 
; 261  :     EnterCriticalSection(&m_cs);
; 262  :     bDone = m_hOwnerThread == 0 && m_cWaitingThreads == 0;

  0000c	ea000004	 b           |$LN14@CritSec_Ex|
  00010		 |$LL2@CritSec_Ex|

; 263  :     LeaveCriticalSection(&m_cs);
; 264  : 
; 265  :     while (!bDone) {
; 266  :         // force someone to wake up, leaving the event reset
; 267  :         // so that the next statement can actually block.
; 268  :         PulseEvent(m_hev);

  00010	e3a01001	 mov         r1, #1
  00014	eb000000	 bl          EventModify

; 269  : 
; 270  :         // and wait for the next waiting thread to set the event again
; 271  :         // which will happen when they relinquish or when they note the
; 272  :         // m_fClosing flag.
; 273  :         WaitForSingleObject(m_hev, INFINITE);

  00018	e594000c	 ldr         r0, [r4, #0xC]
  0001c	e3e01000	 mvn         r1, #0
  00020	eb000000	 bl          WaitForSingleObject
  00024		 |$LN14@CritSec_Ex|

; 274  : 
; 275  :         EnterCriticalSection(&m_cs);

  00024	e2840010	 add         r0, r4, #0x10
  00028	eb000000	 bl          EnterCriticalSection

; 276  :         bDone = m_hOwnerThread == 0 && m_cWaitingThreads == 0;

  0002c	e5943000	 ldr         r3, [r4]

; 277  :         LeaveCriticalSection(&m_cs);

  00030	e2840010	 add         r0, r4, #0x10
  00034	e3530000	 cmp         r3, #0
  00038	05943008	 ldreq       r3, [r4, #8]
  0003c	03530000	 cmpeq       r3, #0
  00040	03a05001	 moveq       r5, #1
  00044	13a05000	 movne       r5, #0
  00048	eb000000	 bl          LeaveCriticalSection

; 278  :     }
; 279  : 
; 280  :     CloseHandle(m_hev);

  0004c	e594000c	 ldr         r0, [r4, #0xC]
  00050	e3550000	 cmp         r5, #0
  00054	0affffed	 beq         |$LL2@CritSec_Ex|
  00058	eb000000	 bl          CloseHandle

; 281  :     DeleteCriticalSection(&m_cs);

  0005c	e2840010	 add         r0, r4, #0x10
  00060	eb000000	 bl          DeleteCriticalSection

; 282  : }

  00064	e8bd4030	 ldmia       sp!, {r4, r5, lr}
  00068	e12fff1e	 bx          lr
  0006c		 |$M33959|

			 ENDP  ; |??1CritSec_Ex@@QAA@XZ|, CritSec_Ex::~CritSec_Ex

	EXPORT	|??0Countdown@@QAA@K@Z|			; Countdown::Countdown
	IMPORT	|InitializeCriticalSection|
	IMPORT	|CreateEventW|

  00000			 AREA	 |.pdata|, PDATA
|$T33974| DCD	|$LN7@Countdown|
	DCD	0x40001301
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |??0Countdown@@QAA@K@Z| PROC		; Countdown::Countdown

; 286  : {

  00000		 |$LN7@Countdown|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M33971|
  00004	e3510000	 cmp         r1, #0
  00008	e1a04000	 mov         r4, r0

; 287  :     count = cInitial;

  0000c	e584101c	 str         r1, [r4, #0x1C]

; 288  :     hev = CreateEvent(NULL, TRUE, cInitial ? FALSE : TRUE, NULL);

  00010	13a02000	 movne       r2, #0
  00014	03a02001	 moveq       r2, #1
  00018	e3a01001	 mov         r1, #1
  0001c	e3a03000	 mov         r3, #0
  00020	e3a00000	 mov         r0, #0
  00024	eb000000	 bl          CreateEventW
  00028	e1a03000	 mov         r3, r0

; 289  :     InitializeCriticalSection(&cs);

  0002c	e1a00004	 mov         r0, r4
  00030	e5843014	 str         r3, [r4, #0x14]
  00034	eb000000	 bl          InitializeCriticalSection

; 290  :     lock = FALSE;

  00038	e3a03000	 mov         r3, #0
  0003c	e5843018	 str         r3, [r4, #0x18]

; 291  : }

  00040	e1a00004	 mov         r0, r4
  00044	e8bd4010	 ldmia       sp!, {r4, lr}
  00048	e12fff1e	 bx          lr
  0004c		 |$M33972|

			 ENDP  ; |??0Countdown@@QAA@K@Z|, Countdown::Countdown

	EXPORT	|?IncrCountdown@Countdown@@QAAHXZ|	; Countdown::IncrCountdown
; File c:\wince600\public\common\sdk\inc\kfuncs.h

  00000			 AREA	 |.pdata|, PDATA
|$T33989| DCD	|$LN10@IncrCountd|
	DCD	0x40001401
; Function compile flags: /Ogspy
; File c:\wince600\platform\common\src\soc\common_ti_v1\omap3530\musb\musbhcd\usb2com\sync.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?IncrCountdown@Countdown@@QAAHXZ| PROC ; Countdown::IncrCountdown

; 294  : {

  00000		 |$LN10@IncrCountd|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004		 |$M33986|
  00004	e1a04000	 mov         r4, r0

; 295  :     BOOL r = TRUE;
; 296  : 
; 297  :     EnterCriticalSection(&cs);

  00008	e3a05001	 mov         r5, #1
  0000c	eb000000	 bl          EnterCriticalSection

; 298  :     if (lock)

  00010	e5943018	 ldr         r3, [r4, #0x18]
  00014	e3530000	 cmp         r3, #0

; 299  :         r = FALSE;

  00018	13a05000	 movne       r5, #0
  0001c	1a000006	 bne         |$LN6@IncrCountd|

; 300  :     else
; 301  :         if (count++ == 0)

  00020	e594301c	 ldr         r3, [r4, #0x1C]
  00024	e3530000	 cmp         r3, #0

; 302  :             ResetEvent(hev);

  00028	05940014	 ldreq       r0, [r4, #0x14]
  0002c	e2833001	 add         r3, r3, #1
  00030	03a01002	 moveq       r1, #2
  00034	e584301c	 str         r3, [r4, #0x1C]
  00038	0b000000	 bleq        EventModify
  0003c		 |$LN6@IncrCountd|

; 303  :     LeaveCriticalSection(&cs);

  0003c	e1a00004	 mov         r0, r4
  00040	eb000000	 bl          LeaveCriticalSection

; 304  : 
; 305  :     return r;
; 306  : }

  00044	e1a00005	 mov         r0, r5
  00048	e8bd4030	 ldmia       sp!, {r4, r5, lr}
  0004c	e12fff1e	 bx          lr
  00050		 |$M33987|

			 ENDP  ; |?IncrCountdown@Countdown@@QAAHXZ|, Countdown::IncrCountdown

	EXPORT	|?DecrCountdown@Countdown@@QAAXXZ|	; Countdown::DecrCountdown
; File c:\wince600\public\common\sdk\inc\kfuncs.h

  00000			 AREA	 |.pdata|, PDATA
|$T34001| DCD	|$LN8@DecrCountd@2|
	DCD	0x40000d01
; Function compile flags: /Ogspy
; File c:\wince600\platform\common\src\soc\common_ti_v1\omap3530\musb\musbhcd\usb2com\sync.cpp

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?DecrCountdown@Countdown@@QAAXXZ| PROC ; Countdown::DecrCountdown

; 309  : {

  00000		 |$LN8@DecrCountd@2|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M33998|
  00004	e1a04000	 mov         r4, r0

; 310  :     EnterCriticalSection(&cs);

  00008	eb000000	 bl          EnterCriticalSection

; 311  :     ASSERT(count > 0);
; 312  :     if (--count == 0)

  0000c	e594301c	 ldr         r3, [r4, #0x1C]
  00010	e2533001	 subs        r3, r3, #1

; 313  :         SetEvent(hev);

  00014	05940014	 ldreq       r0, [r4, #0x14]
  00018	03a01003	 moveq       r1, #3
  0001c	e584301c	 str         r3, [r4, #0x1C]
  00020	0b000000	 bleq        EventModify

; 314  :     LeaveCriticalSection(&cs);

  00024	e1a00004	 mov         r0, r4
  00028	eb000000	 bl          LeaveCriticalSection

; 315  : }

  0002c	e8bd4010	 ldmia       sp!, {r4, lr}
  00030	e12fff1e	 bx          lr
  00034		 |$M33999|

			 ENDP  ; |?DecrCountdown@Countdown@@QAAXXZ|, Countdown::DecrCountdown

	EXPORT	|?LockCountdown@Countdown@@AAAXXZ|	; Countdown::LockCountdown

  00000			 AREA	 |.pdata|, PDATA
|$T34009| DCD	|$LN5@LockCountd|
	DCD	0x40000901
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?LockCountdown@Countdown@@AAAXXZ| PROC ; Countdown::LockCountdown

; 318  : {

  00000		 |$LN5@LockCountd|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M34006|
  00004	e1a04000	 mov         r4, r0

; 319  :     EnterCriticalSection(&cs);

  00008	eb000000	 bl          EnterCriticalSection

; 320  :     lock = TRUE;

  0000c	e3a03001	 mov         r3, #1

; 321  :     LeaveCriticalSection(&cs);

  00010	e1a00004	 mov         r0, r4
  00014	e5843018	 str         r3, [r4, #0x18]
  00018	eb000000	 bl          LeaveCriticalSection

; 322  : }

  0001c	e8bd4010	 ldmia       sp!, {r4, lr}
  00020	e12fff1e	 bx          lr
  00024		 |$M34007|

			 ENDP  ; |?LockCountdown@Countdown@@AAAXXZ|, Countdown::LockCountdown

	EXPORT	|?WaitForCountdown@Countdown@@QAAXH@Z|	; Countdown::WaitForCountdown

  00000			 AREA	 |.pdata|, PDATA
|$T34021| DCD	|$LN7@WaitForCou|
	DCD	0x40000e01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?WaitForCountdown@Countdown@@QAAXH@Z| PROC ; Countdown::WaitForCountdown

; 326  : {

  00000		 |$LN7@WaitForCou|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004		 |$M34018|
  00004	e1a05001	 mov         r5, r1
  00008	e1a04000	 mov         r4, r0

; 327  :     LockCountdown();

  0000c	eb000000	 bl          EnterCriticalSection
  00010	e3a03001	 mov         r3, #1
  00014	e1a00004	 mov         r0, r4
  00018	e5843018	 str         r3, [r4, #0x18]
  0001c	eb000000	 bl          LeaveCriticalSection

; 328  :     
; 329  :     WaitForSingleObject(hev, INFINITE);

  00020	e5940014	 ldr         r0, [r4, #0x14]
  00024	e3e01000	 mvn         r1, #0
  00028	eb000000	 bl          WaitForSingleObject

; 330  :     ASSERT(count == 0);
; 331  : 
; 332  :     lock = keepLocked;

  0002c	e5845018	 str         r5, [r4, #0x18]

; 333  : }

  00030	e8bd4030	 ldmia       sp!, {r4, r5, lr}
  00034	e12fff1e	 bx          lr
  00038		 |$M34019|

			 ENDP  ; |?WaitForCountdown@Countdown@@QAAXH@Z|, Countdown::WaitForCountdown

	EXPORT	|??1Countdown@@QAA@XZ|			; Countdown::~Countdown

  00000			 AREA	 |.pdata|, PDATA
|$T34029| DCD	|$LN5@Countdown@2|
	DCD	0x40000a01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |??1Countdown@@QAA@XZ| PROC		; Countdown::~Countdown

; 336  : {

  00000		 |$LN5@Countdown@2|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M34026|
  00004	e1a04000	 mov         r4, r0

; 337  :     WaitForCountdown( TRUE);

  00008	e3a01001	 mov         r1, #1
  0000c	eb000000	 bl          |?WaitForCountdown@Countdown@@QAAXH@Z|

; 338  : 
; 339  :     CloseHandle(hev);

  00010	e5940014	 ldr         r0, [r4, #0x14]
  00014	eb000000	 bl          CloseHandle

; 340  :     DeleteCriticalSection(&cs);

  00018	e1a00004	 mov         r0, r4
  0001c	eb000000	 bl          DeleteCriticalSection

; 341  : }

  00020	e8bd4010	 ldmia       sp!, {r4, lr}
  00024	e12fff1e	 bx          lr
  00028		 |$M34027|

			 ENDP  ; |??1Countdown@@QAA@XZ|, Countdown::~Countdown

	EXPORT	|??0CritSec_Ex@@QAA@XZ|			; CritSec_Ex::CritSec_Ex
	IMPORT	|RaiseException|

  00000			 AREA	 |.pdata|, PDATA
|$T34039| DCD	|$LN6@CritSec_Ex@2|
	DCD	0x40001501
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |??0CritSec_Ex@@QAA@XZ| PROC		; CritSec_Ex::CritSec_Ex

; 218  : {

  00000		 |$LN6@CritSec_Ex@2|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M34036|
  00004	e1a04000	 mov         r4, r0

; 219  :     m_hev = CreateEvent(NULL, FALSE, TRUE, 0);   // initially set!

  00008	e3a03000	 mov         r3, #0
  0000c	e3a02001	 mov         r2, #1
  00010	e3a01000	 mov         r1, #0
  00014	e3a00000	 mov         r0, #0
  00018	eb000000	 bl          CreateEventW
  0001c	e3500000	 cmp         r0, #0
  00020	e584000c	 str         r0, [r4, #0xC]

; 220  :     if (m_hev == NULL) {
; 221  :         // simulate InitializeCriticalSection - see docs
; 222  :         RaiseException((DWORD)STATUS_NO_MEMORY, 0, 0, NULL);

  00024	03a03000	 moveq       r3, #0
  00028	03a02000	 moveq       r2, #0
  0002c	03a01000	 moveq       r1, #0
  00030	03a0015f	 moveq       r0, #0x5F, 2
  00034	0b000000	 bleq        RaiseException

; 223  :     }
; 224  :     InitializeCriticalSection(&m_cs);

  00038	e2840010	 add         r0, r4, #0x10
  0003c	eb000000	 bl          InitializeCriticalSection

; 225  :     Initialize();

  00040	e1a00004	 mov         r0, r4
  00044	eb000000	 bl          |?Initialize@CritSec_Ex@@QAAXXZ|

; 226  : }

  00048	e1a00004	 mov         r0, r4
  0004c	e8bd4010	 ldmia       sp!, {r4, lr}
  00050	e12fff1e	 bx          lr
  00054		 |$M34037|

			 ENDP  ; |??0CritSec_Ex@@QAA@XZ|, CritSec_Ex::CritSec_Ex

	END
