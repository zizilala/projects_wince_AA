; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\COMMON_TI_V1\AM3517\MCBSP\mcbsp.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?SocMcbspDevConf@@YAXPAUMcBSPDevice_t@@@Z| ; SocMcbspDevConf
	IMPORT	|MmUnmapIoSpace|
	IMPORT	|MmMapIoSpace|
; File c:\wince600\platform\common\src\soc\common_ti_v1\am3517\mcbsp\mcbsp.cpp

  00000			 AREA	 |.pdata|, PDATA
|$T38686| DCD	|$LN33@SocMcbspDe|
	DCD	0x40004f01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |?SocMcbspDevConf@@YAXPAUMcBSPDevice_t@@@Z| PROC ; SocMcbspDevConf

; 14   : {

  00000		 |$LN33@SocMcbspDe|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M38683|
  00004	e1a04000	 mov         r4, r0

; 15   : 	OMAP_SYSC_GENERAL_REGS* pSyscRegs = NULL;
; 16   : 	PHYSICAL_ADDRESS pa; 
; 17   : 	DWORD val		 = 0;
; 18   : 	UINT32 *pAddress = NULL;
; 19   : 	
; 20   : 	// Map System Control Registers
; 21   : 	pa.QuadPart = OMAP_SYSC_GENERAL_REGS_PA;

  00008	e59f0128	 ldr         r0, [pc, #0x128]
  0000c	e3a01000	 mov         r1, #0

; 22   : 	pSyscRegs = (OMAP_SYSC_GENERAL_REGS*)MmMapIoSpace(
; 23   :         pa, sizeof(OMAP_SYSC_GENERAL_REGS), FALSE
; 24   :         );

  00010	e3a03000	 mov         r3, #0
  00014	e3a02ea6	 mov         r2, #0xA6, 28
  00018	eb000000	 bl          MmMapIoSpace
  0001c	e3500000	 cmp         r0, #0

; 25   : 
; 26   : 	if (pSyscRegs == NULL)

  00020	0a000042	 beq         |$LN29@SocMcbspDe|

; 27   : 	{
; 28   : 		return;
; 29   : 	}
; 30   : 
; 31   :     switch (pDevice->deviceID)

  00024	e594100c	 ldr         r1, [r4, #0xC]
  00028	e3510003	 cmp         r1, #3
  0002c	0a000008	 beq         |$LN25@SocMcbspDe|
  00030	e3510004	 cmp         r1, #4
  00034	0a000004	 beq         |$LN24@SocMcbspDe|
  00038	e351002a	 cmp         r1, #0x2A
  0003c	0a000004	 beq         |$LN25@SocMcbspDe|
  00040	9a000038	 bls         |$cleanUp$38627|
  00044	e351002c	 cmp         r1, #0x2C

; 43   : 
; 44   :         default:
; 45   :             goto cleanUp;

  00048	8a000036	 bhi         |$cleanUp$38627|
  0004c		 |$LN24@SocMcbspDe|

; 36   :             break;
; 37   : 
; 38   :         case OMAP_DEVICE_MCBSP3:
; 39   :         case OMAP_DEVICE_MCBSP4:
; 40   :         case OMAP_DEVICE_MCBSP5:
; 41   :             pAddress = (UINT32*)&pSyscRegs->CONTROL_DEVCONF1;

  0004c	e280e068	 add         lr, r0, #0x68

; 42   :             break;

  00050	ea000000	 b           |$LN26@SocMcbspDe|
  00054		 |$LN25@SocMcbspDe|

; 32   :     {
; 33   :         case OMAP_DEVICE_MCBSP1:
; 34   :         case OMAP_DEVICE_MCBSP2:
; 35   :             pAddress = (UINT32*)&pSyscRegs->CONTROL_DEVCONF0;

  00054	e280e004	 add         lr, r0, #4
  00058		 |$LN26@SocMcbspDe|

; 46   :             break;
; 47   :     }
; 48   : 
; 49   : 	val = INREG32(pAddress);
; 50   : 
; 51   :     if (pDevice->clksPinSrc)

  00058	e5943124	 ldr         r3, [r4, #0x124]
  0005c	e59e2000	 ldr         r2, [lr]
  00060	e3530000	 cmp         r3, #0
  00064	0a000011	 beq         |$LN21@SocMcbspDe|

; 52   : 	{
; 53   :         switch (pDevice->deviceID)

  00068	e3510003	 cmp         r1, #3
  0006c	0a000007	 beq         |$LN18@SocMcbspDe|
  00070	e3510004	 cmp         r1, #4
  00074	0a00000b	 beq         |$LN14@SocMcbspDe|
  00078	e351002a	 cmp         r1, #0x2A
  0007c	0a000007	 beq         |$LN17@SocMcbspDe|
  00080	e351002b	 cmp         r1, #0x2B
  00084	0a000003	 beq         |$LN16@SocMcbspDe|
  00088	e351002c	 cmp         r1, #0x2C
  0008c	1a000012	 bne         |$LN11@SocMcbspDe|
  00090		 |$LN18@SocMcbspDe|

; 54   :         {
; 55   :         case OMAP_DEVICE_MCBSP1:
; 56   :             val |= DEVCONF0_MCBSP1_CLKS;

  00090	e3822004	 orr         r2, r2, #4

; 70   :         }
; 71   : 	}
; 72   :     else

  00094	ea000010	 b           |$LN11@SocMcbspDe|
  00098		 |$LN16@SocMcbspDe|

; 61   :         case OMAP_DEVICE_MCBSP3:
; 62   :             val |= DEVCONF1_MCBSP3_CLKS;

  00098	e3822001	 orr         r2, r2, #1

; 63   :             break;

  0009c	ea00000e	 b           |$LN11@SocMcbspDe|
  000a0		 |$LN17@SocMcbspDe|

; 57   :             break;
; 58   :         case OMAP_DEVICE_MCBSP2:
; 59   :             val |= DEVCONF0_MCBSP2_CLKS;

  000a0	e3822040	 orr         r2, r2, #0x40

; 60   :             break;

  000a4	ea00000c	 b           |$LN11@SocMcbspDe|
  000a8		 |$LN14@SocMcbspDe|

; 64   :         case OMAP_DEVICE_MCBSP4:
; 65   :             val |= DEVCONF1_MCBSP4_CLKS;
; 66   :             break;
; 67   :         case OMAP_DEVICE_MCBSP5:
; 68   :             val |= DEVCONF1_MCBSP5_CLKS;

  000a8	e3822010	 orr         r2, r2, #0x10

; 69   :             break;

  000ac	ea00000a	 b           |$LN11@SocMcbspDe|
  000b0		 |$LN21@SocMcbspDe|

; 73   : 	{
; 74   :         switch (pDevice->deviceID)

  000b0	e3510003	 cmp         r1, #3
  000b4	0a000007	 beq         |$LN10@SocMcbspDe|
  000b8	e3510004	 cmp         r1, #4
  000bc	0a000011	 beq         |$LN6@SocMcbspDe|
  000c0	e351002a	 cmp         r1, #0x2A
  000c4	0a00000d	 beq         |$LN9@SocMcbspDe|
  000c8	e351002b	 cmp         r1, #0x2B
  000cc	0a000009	 beq         |$LN8@SocMcbspDe|
  000d0	e351002c	 cmp         r1, #0x2C
  000d4	1a000000	 bne         |$LN11@SocMcbspDe|
  000d8		 |$LN10@SocMcbspDe|

; 75   :         {
; 76   :         case OMAP_DEVICE_MCBSP1:
; 77   :             val &= ~DEVCONF0_MCBSP1_CLKS;

  000d8	e3c22004	 bic         r2, r2, #4
  000dc		 |$LN11@SocMcbspDe|

; 91   :         }
; 92   : 	}
; 93   : 
; 94   : 	// Special case for McBSP1
; 95   : 	if (pDevice->deviceID == OMAP_DEVICE_MCBSP1)

  000dc	e3510003	 cmp         r1, #3
  000e0	1a00000f	 bne         |$LN1@SocMcbspDe|

; 96   : 	{
; 97   : 		if (pDevice->clockModeRx)

  000e4	e59430fc	 ldr         r3, [r4, #0xFC]
  000e8	e3530000	 cmp         r3, #0
  000ec	0a000007	 beq         |$LN4@SocMcbspDe|

; 98   : 		{
; 99   : 			val |= DEVCONF0_MCBSP1_CLKR;			

  000f0	e3822008	 orr         r2, r2, #8

; 100  : 		}
; 101  : 		else

  000f4	ea000006	 b           |$LN3@SocMcbspDe|
  000f8		 |$LN8@SocMcbspDe|

; 82   :         case OMAP_DEVICE_MCBSP3:
; 83   :             val &= ~DEVCONF1_MCBSP3_CLKS;

  000f8	e3c22001	 bic         r2, r2, #1

; 84   :             break;

  000fc	eafffff6	 b           |$LN11@SocMcbspDe|
  00100		 |$LN9@SocMcbspDe|

; 78   :             break;
; 79   :         case OMAP_DEVICE_MCBSP2:
; 80   :             val &= ~DEVCONF0_MCBSP2_CLKS;

  00100	e3c22040	 bic         r2, r2, #0x40

; 81   :             break;

  00104	eafffff4	 b           |$LN11@SocMcbspDe|
  00108		 |$LN6@SocMcbspDe|

; 85   :         case OMAP_DEVICE_MCBSP4:
; 86   :             val &= ~DEVCONF1_MCBSP4_CLKS;
; 87   :             break;
; 88   :         case OMAP_DEVICE_MCBSP5:
; 89   :             val &= ~DEVCONF1_MCBSP5_CLKS;

  00108	e3c22010	 bic         r2, r2, #0x10

; 90   :             break;

  0010c	eafffff2	 b           |$LN11@SocMcbspDe|
  00110		 |$LN4@SocMcbspDe|

; 102  : 		{
; 103  : 			val &= ~DEVCONF0_MCBSP1_CLKR;

  00110	e3c22008	 bic         r2, r2, #8
  00114		 |$LN3@SocMcbspDe|

; 104  : 		}
; 105  : 
; 106  : 		if (pDevice->frameSyncSourceRx)

  00114	e5943100	 ldr         r3, [r4, #0x100]
  00118	e3530000	 cmp         r3, #0

; 107  : 		{
; 108  : 			val |= DEVCONF0_MCBSP1_FSR;

  0011c	13822010	 orrne       r2, r2, #0x10

; 109  : 		}
; 110  : 		else
; 111  : 		{
; 112  : 			val &= ~DEVCONF0_MCBSP1_FSR;

  00120	03c22010	 biceq       r2, r2, #0x10
  00124		 |$LN1@SocMcbspDe|

; 113  : 		}
; 114  : 	}
; 115  : 
; 116  :     OUTREG32(pAddress, val);

  00124	e58e2000	 str         r2, [lr]
  00128		 |$cleanUp$38627|

; 117  : 
; 118  : cleanUp:
; 119  : 
; 120  : 	MmUnmapIoSpace((PVOID)pSyscRegs, sizeof(OMAP_SYSC_GENERAL_REGS));

  00128	e3a01ea6	 mov         r1, #0xA6, 28
  0012c	eb000000	 bl          MmUnmapIoSpace
  00130		 |$LN29@SocMcbspDe|

; 121  : }

  00130	e8bd4010	 ldmia       sp!, {r4, lr}
  00134	e12fff1e	 bx          lr
  00138		 |$LN34@SocMcbspDe|
  00138		 |$LN35@SocMcbspDe|
  00138	48002270	 DCD         0x48002270
  0013c		 |$M38684|

			 ENDP  ; |?SocMcbspDevConf@@YAXPAUMcBSPDevice_t@@@Z|, SocMcbspDevConf

	END
