; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\SOC\COMMON_TI_V1\COMMON_TI\SDHC\BASE\sdhcmain.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|?m_cmdArrSize@CSDIOControllerBase@@2KB| [ DATA ] ; CSDIOControllerBase::m_cmdArrSize
	EXPORT	|dpCurSettings| [ DATA ]

  00000			 AREA	 |.data|, DATA
|dpCurSettings| DCB "S", 0x0, "D", 0x0, "H", 0x0, "C", 0x0, 0x0, 0x0
	%	54
	DCB	"I", 0x0, "n", 0x0, "t", 0x0, "e", 0x0, "r", 0x0, "r", 0x0
	DCB	"u", 0x0, "p", 0x0, "t", 0x0, "s", 0x0, 0x0, 0x0
	%	42
	DCB	"S", 0x0, "e", 0x0, "n", 0x0, "d", 0x0, " ", 0x0, "H", 0x0
	DCB	"a", 0x0, "n", 0x0, "d", 0x0, "l", 0x0, "e", 0x0, "r", 0x0
	DCB	0x0, 0x0
	%	38
	DCB	"R", 0x0, "e", 0x0, "s", 0x0, "p", 0x0, "o", 0x0, "n", 0x0
	DCB	"s", 0x0, "e", 0x0, "s", 0x0, 0x0, 0x0
	%	44
	DCB	"R", 0x0, "e", 0x0, "c", 0x0, "e", 0x0, "i", 0x0, "v", 0x0
	DCB	"e", 0x0, " ", 0x0, "D", 0x0, "a", 0x0, "t", 0x0, "a", 0x0
	DCB	0x0, 0x0
	%	38
	DCB	"C", 0x0, "l", 0x0, "o", 0x0, "c", 0x0, "k", 0x0, " ", 0x0
	DCB	"C", 0x0, "o", 0x0, "n", 0x0, "t", 0x0, "r", 0x0, "o", 0x0
	DCB	"l", 0x0, 0x0, 0x0
	%	36
	DCB	"T", 0x0, "r", 0x0, "a", 0x0, "n", 0x0, "s", 0x0, "m", 0x0
	DCB	"i", 0x0, "t", 0x0, " ", 0x0, "D", 0x0, "a", 0x0, "t", 0x0
	DCB	"a", 0x0, 0x0, 0x0
	%	36
	DCB	"S", 0x0, "D", 0x0, "B", 0x0, "u", 0x0, "s", 0x0, " ", 0x0
	DCB	"I", 0x0, "n", 0x0, "t", 0x0, "e", 0x0, "r", 0x0, "a", 0x0
	DCB	"c", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, 0x0, 0x0
	%	28
	DCB	"C", 0x0, "a", 0x0, "r", 0x0, "d", 0x0, " ", 0x0, "B", 0x0
	DCB	"u", 0x0, "s", 0x0, "y", 0x0, " ", 0x0, "S", 0x0, "t", 0x0
	DCB	"a", 0x0, "t", 0x0, "e", 0x0, 0x0, 0x0
	%	32
	DCB	"D", 0x0, "V", 0x0, "F", 0x0, "S", 0x0, 0x0, 0x0
	%	54
	DCB	"C", 0x0, "E", 0x0, "L", 0x0, "O", 0x0, "G", 0x0, "M", 0x0
	DCB	"S", 0x0, "G", 0x0, 0x0, 0x0
	%	46
	DCB	"F", 0x0, "u", 0x0, "n", 0x0, "c", 0x0, "t", 0x0, "i", 0x0
	DCB	"o", 0x0, "n", 0x0, "s", 0x0, 0x0, 0x0
	%	44
	DCB	"I", 0x0, "n", 0x0, "f", 0x0, "o", 0x0, "r", 0x0, "m", 0x0
	DCB	"a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, 0x0, 0x0
	%	40
	DCB	"I", 0x0, "n", 0x0, "i", 0x0, "t", 0x0, 0x0, 0x0
	%	54
	DCB	"W", 0x0, "a", 0x0, "r", 0x0, "n", 0x0, "i", 0x0, "n", 0x0
	DCB	"g", 0x0, "s", 0x0, 0x0, 0x0
	%	46
	DCB	"E", 0x0, "r", 0x0, "r", 0x0, "o", 0x0, "r", 0x0, "s", 0x0
	DCB	0x0, 0x0
	%	50
	DCB	"U", 0x0, "n", 0x0, "d", 0x0, "e", 0x0, "f", 0x0, "i", 0x0
	DCB	"n", 0x0, "e", 0x0, "d", 0x0, 0x0, 0x0
	%	44
	DCD	0xf000

  00000			 AREA	 |.rdata|, DATA, READONLY
|?m_cmdArrSize@CSDIOControllerBase@@2KB| DCD 0x20	; CSDIOControllerBase::m_cmdArrSize
	EXPORT	|DllEntry|
	IMPORT	|SDHCDDeinitializeHCLib|
	IMPORT	|SDDeinitializeCardLib|
	IMPORT	|SDHCDInitializeHCLib|
	IMPORT	|SDInitializeCardLib|
	IMPORT	|DisableThreadLibraryCalls|
	IMPORT	|RegisterDbgZones|
; File c:\wince600\platform\common\src\soc\common_ti_v1\common_ti\sdhc\base\sdhcmain.cpp

  00000			 AREA	 |.pdata|, PDATA
|$T42196| DCD	|$LN12@DllEntry|
	DCD	0x40001b01
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |DllEntry| PROC

; 51   : {

  00000		 |$LN12@DllEntry|
  00000	e92d4010	 stmdb       sp!, {r4, lr}
  00004		 |$M42193|
  00004	e1a04000	 mov         r4, r0

; 52   : 	UNREFERENCED_PARAMETER(pReserved);
; 53   :     if ( Reason == DLL_PROCESS_ATTACH ) {

  00008	e3510001	 cmp         r1, #1
  0000c	1a00000e	 bne         |$LN6@DllEntry|

; 54   :         RETAILREGISTERZONES((HMODULE)hInstance);

  00010	e59f1050	 ldr         r1, [pc, #0x50]
  00014	eb000000	 bl          RegisterDbgZones

; 55   :         DisableThreadLibraryCalls((HMODULE) hInstance);

  00018	e1a00004	 mov         r0, r4
  0001c	eb000000	 bl          DisableThreadLibraryCalls

; 56   : 
; 57   :         if( !SDInitializeCardLib() )

  00020	eb000000	 bl          SDInitializeCardLib
  00024	e3500000	 cmp         r0, #0
  00028	1a000002	 bne         |$LN5@DllEntry|
  0002c		 |$LN9@DllEntry|

; 58   :         {
; 59   :             return FALSE;

  0002c	e3a00000	 mov         r0, #0

; 74   : }

  00030	e8bd4010	 ldmia       sp!, {r4, lr}
  00034	e12fff1e	 bx          lr
  00038		 |$LN5@DllEntry|

; 60   :         }
; 61   :         else if( !SD_API_SUCCESS( SDHCDInitializeHCLib() ) )

  00038	eb000000	 bl          SDHCDInitializeHCLib
  0003c	e3500000	 cmp         r0, #0
  00040	5a000005	 bpl         |$LN1@DllEntry|

; 62   :         {
; 63   :             SDDeinitializeCardLib();

  00044	eb000000	 bl          SDDeinitializeCardLib

; 64   :             return FALSE;

  00048	eafffff7	 b           |$LN9@DllEntry|
  0004c		 |$LN6@DllEntry|

; 65   :         }
; 66   :     }
; 67   :     else if ( Reason == DLL_PROCESS_DETACH ) 

  0004c	e3510000	 cmp         r1, #0
  00050	1a000001	 bne         |$LN1@DllEntry|

; 68   :     {
; 69   :         SDHCDDeinitializeHCLib();

  00054	eb000000	 bl          SDHCDDeinitializeHCLib

; 70   :         SDDeinitializeCardLib();

  00058	eb000000	 bl          SDDeinitializeCardLib
  0005c		 |$LN1@DllEntry|

; 71   :     }
; 72   :     
; 73   :     return(TRUE);

  0005c	e3a00001	 mov         r0, #1

; 74   : }

  00060	e8bd4010	 ldmia       sp!, {r4, lr}
  00064	e12fff1e	 bx          lr
  00068		 |$LN13@DllEntry|
  00068		 |$LN14@DllEntry|
  00068	00000000	 DCD         |dpCurSettings|
  0006c		 |$M42194|

			 ENDP  ; |DllEntry|

	EXPORT	|SHC_Deinit|
	IMPORT	|?FreeHostContext@CSDIOControllerBase@@QAAXHH@Z| ; CSDIOControllerBase::FreeHostContext

  00000			 AREA	 |.pdata|, PDATA
|$T42208| DCD	|$LN5@SHC_Deinit|
	DCD	0x40000701
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SHC_Deinit| PROC

; 129  : {    

  00000		 |$LN5@SHC_Deinit|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M42205|

; 130  :     DEBUGMSG(SDCARD_ZONE_INIT, (TEXT("SDHC +Deinit\n")));
; 131  :     
; 132  :     CSDIOControllerBase *pController = (CSDIOControllerBase*) hDeviceContext;    
; 133  :     pController->FreeHostContext( TRUE, TRUE );

  00004	e3a02001	 mov         r2, #1
  00008	e3a01001	 mov         r1, #1
  0000c	eb000000	 bl          |?FreeHostContext@CSDIOControllerBase@@QAAXHH@Z|

; 134  :     
; 135  :     DEBUGMSG(SDCARD_ZONE_INIT, (TEXT("SDHC -Deinit\n")));
; 136  :     
; 137  :     return TRUE;

  00010	e3a00001	 mov         r0, #1

; 138  : }

  00014	e49de004	 ldr         lr, [sp], #4
  00018	e12fff1e	 bx          lr
  0001c		 |$M42206|

			 ENDP  ; |SHC_Deinit|

	EXPORT	|SHC_Open|

  00000			 AREA	 |.pdata|, PDATA
|$T42218| DCD	|$LN5@SHC_Open|
	DCD	0x40000100
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SHC_Open| PROC

; 154  : {

  00000		 |$LN5@SHC_Open|
  00000		 |$M42215|

; 155  :     CSDIOControllerBase * pController = (CSDIOControllerBase*) hDeviceContext;
; 156  :     return (DWORD) pController;
; 157  : }

  00000	e12fff1e	 bx          lr
  00004		 |$M42216|

			 ENDP  ; |SHC_Open|

	EXPORT	|SHC_Close|

  00000			 AREA	 |.pdata|, PDATA
|$T42227| DCD	|$LN5@SHC_Close|
	DCD	0x40000200
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SHC_Close| PROC

; 171  : {

  00000		 |$LN5@SHC_Close|
  00000		 |$M42224|

; 172  :     CSDIOControllerBase * pController = (CSDIOControllerBase *) hOpenContext;
; 173  : 	UNREFERENCED_PARAMETER(pController);
; 174  :     return TRUE;

  00000	e3a00001	 mov         r0, #1

; 175  : }

  00004	e12fff1e	 bx          lr
  00008		 |$M42225|

			 ENDP  ; |SHC_Close|

	EXPORT	|SHC_PowerDown|
	IMPORT	|?PowerDown@CSDIOControllerBase@@QAAXXZ| ; CSDIOControllerBase::PowerDown

  00000			 AREA	 |.pdata|, PDATA
|$T42235| DCD	|$LN5@SHC_PowerD|
	DCD	0x40000401
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SHC_PowerDown| PROC

; 188  : {

  00000		 |$LN5@SHC_PowerD|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M42232|

; 189  :     CSDIOControllerBase * pController = (CSDIOControllerBase*) hDeviceContext;
; 190  :     ASSERT( pController != NULL );
; 191  :     pController->PowerDown();

  00004	eb000000	 bl          |?PowerDown@CSDIOControllerBase@@QAAXXZ|

; 192  : }

  00008	e49de004	 ldr         lr, [sp], #4
  0000c	e12fff1e	 bx          lr
  00010		 |$M42233|

			 ENDP  ; |SHC_PowerDown|

	EXPORT	|SHC_PowerUp|
	IMPORT	|?PowerUp@CSDIOControllerBase@@QAAXXZ|	; CSDIOControllerBase::PowerUp

  00000			 AREA	 |.pdata|, PDATA
|$T42243| DCD	|$LN5@SHC_PowerU|
	DCD	0x40000401
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SHC_PowerUp| PROC

; 205  : {

  00000		 |$LN5@SHC_PowerU|
  00000	e52de004	 str         lr, [sp, #-4]!
  00004		 |$M42240|

; 206  :     CSDIOControllerBase * pController = (CSDIOControllerBase*) hDeviceContext;
; 207  :     ASSERT( pController != NULL );
; 208  :     pController->PowerUp();

  00004	eb000000	 bl          |?PowerUp@CSDIOControllerBase@@QAAXXZ|

; 209  : }

  00008	e49de004	 ldr         lr, [sp], #4
  0000c	e12fff1e	 bx          lr
  00010		 |$M42241|

			 ENDP  ; |SHC_PowerUp|

	EXPORT	|SHC_IOControl|
	IMPORT	|?SetPower@CSDIOControllerBase@@QAAHW4_CEDEVICE_POWER_STATE@@@Z| ; CSDIOControllerBase::SetPower
	IMPORT	|?ContextRestore@CSDIOControllerBase@@QAAHXZ| ; CSDIOControllerBase::ContextRestore
	IMPORT	|__C_specific_handler|
	IMPORT	|memset|

  00000			 AREA	 |.pdata|, PDATA
|$T42292| DCD	|$LN55@SHC_IOCont|
	DCD	0xc0005804

  00000			 AREA	 |.pdata|, PDATA
|$T42294| DCD	|$LN24@SHC_IOCont|
	DCD	0x40000301

  00000			 AREA	 |.pdata|, PDATA
|$T42296| DCD	|$LN38@SHC_IOCont|
	DCD	0x40000301

  00000			 AREA	 |.pdata|, PDATA
|$T42298| DCD	|$LN31@SHC_IOCont|
	DCD	0x40000601

  00000			 AREA	 |.xdata|, DATA
|$T42290| DCD	0x3
	DCD	|$LN28@SHC_IOCont|
	DCD	|$LN29@SHC_IOCont|
	DCD	|$LN24@SHC_IOCont|
	DCD	|$LN25@SHC_IOCont|
	DCD	|$LN42@SHC_IOCont|
	DCD	|$LN43@SHC_IOCont|
	DCD	|$LN38@SHC_IOCont|
	DCD	|$LN39@SHC_IOCont|
	DCD	|$LN35@SHC_IOCont|
	DCD	|$LN36@SHC_IOCont|
	DCD	|$LN31@SHC_IOCont|
	DCD	|$LN32@SHC_IOCont|
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000	00000000	 DCD         |__C_specific_handler|
  00004	00000000	 DCD         |$T42290|

  00008		 |SHC_IOControl| PROC

; 228  : {

  00008		 |$LN55@SHC_IOCont|
  00008	e1a0c00d	 mov         r12, sp
  0000c	e92d5830	 stmdb       sp!, {r4, r5, r11, r12, lr}
  00010	e28db014	 add         r11, sp, #0x14
  00014	e24dd008	 sub         sp, sp, #8
  00018		 |$LN53@SHC_IOCont|
  00018	e1b02000	 movs        r2, r0

; 229  : 	UNREFERENCED_PARAMETER(dwLenIn);
; 230  : 	UNREFERENCED_PARAMETER(pBufIn);
; 231  :     BOOL rc = FALSE;

  0001c	e3a00000	 mov         r0, #0
  00020	e50b001c	 str         r0, [r11, #-0x1C]

; 232  :     CSDIOControllerBase * pController = (CSDIOControllerBase*) hOpenContext; 
; 233  : 
; 234  :     DEBUGMSG(SDCARD_ZONE_FUNC, (
; 235  :         L"+SHC_IOControl(0x%08x, 0x%08x, 0x%08x, %d, 0x%08x, %d, 0x%08x)\r\n",
; 236  :         hOpenContext, dwCode, pBufIn, dwLenIn, pBufOut, dwLenOut, pdwActualOut
; 237  :         ));
; 238  : 
; 239  :     // Check if we get correct context
; 240  :     if (pController == NULL)

  00024	0a00004c	 beq         |$cleanUp$41427|
  00028	e3a03832	 mov         r3, #0x32, 16

; 241  :     {
; 242  :         DEBUGMSG(SDCARD_ZONE_ERROR, (L"ERROR: SHC_IOControl: "
; 243  :             L"Incorrect context paramer\r\n"
; 244  :             ));
; 245  :         goto cleanUp;
; 246  :     }
; 247  : 
; 248  :     switch (dwCode)

  0002c	e3833a01	 orr         r3, r3, #1, 20
  00030	e1510003	 cmp         r1, r3
  00034	0a000031	 beq         |$LN16@SHC_IOCont|
  00038	e59f3154	 ldr         r3, [pc, #0x154]
  0003c	e1510003	 cmp         r1, r3
  00040	0a000021	 beq         |$LN6@SHC_IOCont|
  00044	e59f3144	 ldr         r3, [pc, #0x144]
  00048	e1510003	 cmp         r1, r3
  0004c	0a000006	 beq         |$LN13@SHC_IOCont|
  00050	e59f3134	 ldr         r3, [pc, #0x134]
  00054	e1510003	 cmp         r1, r3
  00058	1a00003f	 bne         |$cleanUp$41427|

; 323  :                 {
; 324  :                     DEBUGMSG(SDCARD_ZONE_ERROR, (L"Exception in ioctl\r\n"));
; 325  :                 }
; 326  :             }     
; 327  :             break;
; 328  :             
; 329  :         case IOCTL_CONTEXT_RESTORE:
; 330  :             if(pController != NULL)
; 331  :                 {
; 332  :                 pController->ContextRestore();

  0005c	e1a00002	 mov         r0, r2
  00060	eb000000	 bl          |?ContextRestore@CSDIOControllerBase@@QAAHXZ|

; 333  :                 }
; 334  :             else
; 335  :                 {
; 336  :                 DEBUGMSG( ZONE_ERROR, (L"SHC_IOControl: IOCTL_CONTEXT_RESTORE_NOTIFY\r\n"));
; 337  :                 }
; 338  : 
; 339  :             rc = TRUE;

  00064	e3a00001	 mov         r0, #1

; 340  :             break;

  00068	ea00003b	 b           |$cleanUp$41427|
  0006c		 |$LN13@SHC_IOCont|

; 267  :                     {
; 268  :                         DEBUGMSG(SDCARD_ZONE_ERROR, (L"exception in ioctl\r\n"));
; 269  :                     }
; 270  :             }
; 271  :             break;
; 272  : 
; 273  :         // requests a change from one device power state to another
; 274  :         case IOCTL_POWER_SET: 
; 275  :             DEBUGMSG(SDCARD_ZONE_INFO,(L"SHC: Received IOCTL_POWER_SET\r\n"));
; 276  :             if (pBufOut && dwLenOut >= sizeof(CEDEVICE_POWER_STATE)) 

  0006c	e59b1000	 ldr         r1, [r11]
  00070	e3510000	 cmp         r1, #0
  00074	0a000038	 beq         |$cleanUp$41427|
  00078	e59b3004	 ldr         r3, [r11, #4]
  0007c	e3530004	 cmp         r3, #4
  00080	3a000035	 bcc         |$cleanUp$41427|
  00084		 |$LN35@SHC_IOCont|

; 277  :             {
; 278  :                 __try 
; 279  :                 {
; 280  :                     CEDEVICE_POWER_STATE ReqDx = *(PCEDEVICE_POWER_STATE)pBufOut;

  00084	e5913000	 ldr         r3, [r1]
  00088	e3530000	 cmp         r3, #0

; 281  :                     switch (ReqDx)

  0008c	0a000003	 beq         |$LN8@SHC_IOCont|
  00090	e3530004	 cmp         r3, #4
  00094	1a000004	 bne         |$LN9@SHC_IOCont|

; 285  :                             break;
; 286  : 
; 287  :                         case D4:
; 288  :                             pController->SetPower(D4);

  00098	e3a01004	 mov         r1, #4

; 289  :                             break;

  0009c	ea000000	 b           |$LN52@SHC_IOCont|
  000a0		 |$LN8@SHC_IOCont|

; 282  :                     {
; 283  :                         case D0:
; 284  :                             pController->SetPower(D0);

  000a0	e3a01000	 mov         r1, #0
  000a4		 |$LN52@SHC_IOCont|
  000a4	e1a00002	 mov         r0, r2
  000a8	eb000000	 bl          |?SetPower@CSDIOControllerBase@@QAAHW4_CEDEVICE_POWER_STATE@@@Z|
  000ac		 |$LN9@SHC_IOCont|

; 290  :                     }
; 291  :                         
; 292  :                     *pdwActualOut = sizeof(CEDEVICE_POWER_STATE);

  000ac	e59b3008	 ldr         r3, [r11, #8]
  000b0	e3a02004	 mov         r2, #4
  000b4	e5832000	 str         r2, [r3]

; 293  :                     DEBUGMSG(SDCARD_ZONE_INFO, (L"SHC: IOCTL_POWER_SET to D%u, D%u \r\n",
; 294  :                         ReqDx, pController->m_ActualPowerState
; 295  :                         ));
; 296  : 
; 297  :                     rc = TRUE;

  000b8	e3a00001	 mov         r0, #1
  000bc	e50b001c	 str         r0, [r11, #-0x1C]
  000c0		 |$LN36@SHC_IOCont|

; 298  :                 }

  000c0	ea000025	 b           |$cleanUp$41427|
  000c4		 |$LN32@SHC_IOCont|

; 299  :                 __except(EXCEPTION_EXECUTE_HANDLER) 

  000c4	e51b001c	 ldr         r0, [r11, #-0x1C]
  000c8	ea000023	 b           |$cleanUp$41427|
  000cc		 |$LN6@SHC_IOCont|

; 300  :                 {
; 301  :                     DEBUGMSG(SDCARD_ZONE_ERROR, (L"Exception in ioctl\r\n"));
; 302  :                 }
; 303  :             }
; 304  :             break;
; 305  : 
; 306  :         // gets the current device power state
; 307  :         case IOCTL_POWER_GET: 
; 308  :             DEBUGMSG(SDCARD_ZONE_INFO, (L"SHC: Received IOCTL_POWER_GET\r\n"));
; 309  :             if (pBufOut != NULL && dwLenOut >= sizeof(CEDEVICE_POWER_STATE)) 

  000cc	e59b1000	 ldr         r1, [r11]
  000d0	e3510000	 cmp         r1, #0
  000d4	0a000020	 beq         |$cleanUp$41427|
  000d8	e59b3004	 ldr         r3, [r11, #4]
  000dc	e3530004	 cmp         r3, #4
  000e0	3a00001d	 bcc         |$cleanUp$41427|
  000e4		 |$LN42@SHC_IOCont|

; 310  :             {
; 311  :                 __try 
; 312  :                 {
; 313  :                     *(PCEDEVICE_POWER_STATE)pBufOut = pController->m_ActualPowerState;

  000e4	e59230e0	 ldr         r3, [r2, #0xE0]
  000e8	e5813000	 str         r3, [r1]

; 314  :  
; 315  :                     rc = TRUE;

  000ec	e3a00001	 mov         r0, #1
  000f0	e50b001c	 str         r0, [r11, #-0x1C]
  000f4		 |$LN43@SHC_IOCont|

; 316  : 
; 317  :                     DEBUGMSG(SDCARD_ZONE_INFO, (L"SHC: "
; 318  :                             L"IOCTL_POWER_GET to D%u \r\n",
; 319  :                             pController->m_ActualPowerState
; 320  :                             ));
; 321  :                 }

  000f4	ea000018	 b           |$cleanUp$41427|
  000f8		 |$LN39@SHC_IOCont|

; 322  :                 __except(EXCEPTION_EXECUTE_HANDLER) 

  000f8	e51b001c	 ldr         r0, [r11, #-0x1C]
  000fc	ea000016	 b           |$cleanUp$41427|
  00100		 |$LN16@SHC_IOCont|

; 249  :     {
; 250  :         case IOCTL_POWER_CAPABILITIES: 
; 251  :             DEBUGMSG(SDCARD_ZONE_INFO, (L"SHC: Received IOCTL_POWER_CAPABILITIES\r\n"));
; 252  :             if (pBufOut && dwLenOut >= sizeof (POWER_CAPABILITIES) && 
; 253  :                 pdwActualOut) 

  00100	e59b4000	 ldr         r4, [r11]
  00104	e3540000	 cmp         r4, #0
  00108	0a000013	 beq         |$cleanUp$41427|
  0010c	e59b3004	 ldr         r3, [r11, #4]
  00110	e3530030	 cmp         r3, #0x30
  00114	3a000010	 bcc         |$cleanUp$41427|
  00118	e59b5008	 ldr         r5, [r11, #8]
  0011c	e3550000	 cmp         r5, #0
  00120	0a00000d	 beq         |$cleanUp$41427|
  00124		 |$LN28@SHC_IOCont|

; 254  :             {
; 255  :                     __try 
; 256  :                     {
; 257  :                         PPOWER_CAPABILITIES PowerCaps;
; 258  :                         PowerCaps = (PPOWER_CAPABILITIES)pBufOut;
; 259  :          
; 260  :                         // Only supports D0 (permanently on) and D4(off.         
; 261  :                         memset(PowerCaps, 0, sizeof(*PowerCaps));

  00124	e3a02030	 mov         r2, #0x30
  00128	e3a01000	 mov         r1, #0
  0012c	e1a00004	 mov         r0, r4
  00130	eb000000	 bl          memset

; 262  :                         PowerCaps->DeviceDx = (DX_MASK(D0) | DX_MASK(D4)); 

  00134	e3a03011	 mov         r3, #0x11
  00138	e5c43000	 strb        r3, [r4]

; 263  :                         *pdwActualOut = sizeof(*PowerCaps);                        

  0013c	e3a03030	 mov         r3, #0x30
  00140	e5853000	 str         r3, [r5]

; 264  :                         rc = TRUE;

  00144	e3a00001	 mov         r0, #1
  00148	e50b001c	 str         r0, [r11, #-0x1C]
  0014c		 |$LN29@SHC_IOCont|

; 265  :                     }

  0014c	ea000002	 b           |$cleanUp$41427|
  00150		 |$LN25@SHC_IOCont|

; 266  :                     __except(EXCEPTION_EXECUTE_HANDLER) 

  00150	e51b001c	 ldr         r0, [r11, #-0x1C]
  00154	ea000000	 b           |$cleanUp$41427|
  00158		 |$LN51@SHC_IOCont|

; 341  : 
; 342  :     }
; 343  : 
; 344  : cleanUp:
; 345  :     DEBUGMSG(SDCARD_ZONE_FUNC, (L"-SHC_IOControl(rc = %d)\r\n", rc));
; 346  :     return rc;

  00158	e51b0018	 ldr         r0, [r11, #-0x18]
  0015c		 |$cleanUp$41427|

; 347  : }

  0015c	e24bd014	 sub         sp, r11, #0x14
  00160	e89d6830	 ldmia       sp, {r4, r5, r11, sp, lr}
  00164	e12fff1e	 bx          lr

			 ENDP  ; |SHC_IOControl|

  00168		 |$LN24@SHC_IOCont|
  00168		 |$LN54@SHC_IOCont|

; 266  :                     __except(EXCEPTION_EXECUTE_HANDLER) 

  00168	e52de004	 str         lr, [sp, #-4]!
  0016c		 |$LN27@SHC_IOCont|
  0016c		 |$LN59@SHC_IOCont|
  0016c	e3a00001	 mov         r0, #1
  00170		 |$LN26@SHC_IOCont|
  00170	e49df004	 ldr         pc, [sp], #4
  00174		 |$LN60@SHC_IOCont|
  00174		 |$LN38@SHC_IOCont|
  00174		 |$LN56@SHC_IOCont|

; 322  :                 __except(EXCEPTION_EXECUTE_HANDLER) 

  00174	e52de004	 str         lr, [sp, #-4]!
  00178		 |$LN41@SHC_IOCont|
  00178		 |$LN61@SHC_IOCont|
  00178	e3a00001	 mov         r0, #1
  0017c		 |$LN40@SHC_IOCont|
  0017c	e49df004	 ldr         pc, [sp], #4
  00180		 |$LN62@SHC_IOCont|
  00180		 |$LN31@SHC_IOCont|
  00180		 |$LN57@SHC_IOCont|

; 299  :                 __except(EXCEPTION_EXECUTE_HANDLER) 

  00180	e52de004	 str         lr, [sp, #-4]!
  00184		 |$LN34@SHC_IOCont|
  00184		 |$LN63@SHC_IOCont|
  00184	e3a00001	 mov         r0, #1
  00188		 |$LN33@SHC_IOCont|
  00188	e49df004	 ldr         pc, [sp], #4
  0018c		 |$LN65@SHC_IOCont|
  0018c		 |$LN66@SHC_IOCont|
  0018c	80038140	 DCD         0x80038140
  00190		 |$LN67@SHC_IOCont|
  00190	00321008	 DCD         0x321008
  00194		 |$LN68@SHC_IOCont|
  00194	00321004	 DCD         0x321004
  00198		 |$LN64@SHC_IOCont|
  00198		 |$LN58@SHC_IOCont|
	EXPORT	|SHC_Init|
	IMPORT	|?Init@CSDIOControllerBase@@QAAHPBG@Z|	; CSDIOControllerBase::Init
	IMPORT	|?CreateSDIOController@@YAPAVCSDIOControllerBase@@XZ| ; CreateSDIOController

  00000			 AREA	 |.pdata|, PDATA
|$T42329| DCD	|$LN13@SHC_Init|
	DCD	0x40001201
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |SHC_Init| PROC

; 89   : {

  00000		 |$LN13@SHC_Init|
  00000	e92d4070	 stmdb       sp!, {r4 - r6, lr}
  00004		 |$M42326|
  00004	e1a06000	 mov         r6, r0

; 90   :     LPCTSTR pszActiveKey = (LPCTSTR) dwContext;
; 91   :     DWORD   dwRet = 0;

  00008	e3a04000	 mov         r4, #0

; 92   : 
; 93   :     DEBUGMSG(SDCARD_ZONE_INIT, (TEXT("SDHC +Init\n")));    
; 94   :     DEBUGMSG(SDCARD_ZONE_INIT, (TEXT("SDHC Active RegPath: %s \n"), pszActiveKey));
; 95   : 
; 96   :     PCSDIOControllerBase pController = CreateSDIOController();

  0000c	eb000000	 bl          |?CreateSDIOController@@YAPAVCSDIOControllerBase@@XZ|
  00010	e1b05000	 movs        r5, r0

; 97   :     if (!pController) {

  00014	0a000008	 beq         |$LN8@SHC_Init|

; 98   :         DEBUGMSG(SDCARD_ZONE_ERROR, (TEXT("SDHC Failed to create controller object\n")));
; 99   :         goto EXIT;
; 100  :     }
; 101  : 
; 102  :     if (!pController->Init(pszActiveKey)) {

  00018	e1a01006	 mov         r1, r6
  0001c	e1a00005	 mov         r0, r5
  00020	eb000000	 bl          |?Init@CSDIOControllerBase@@QAAHPBG@Z|
  00024	e3500000	 cmp         r0, #0

; 103  :         goto EXIT;
; 104  :     }
; 105  : 
; 106  :     // Return the controller instance
; 107  :     dwRet = (DWORD) pController;
; 108  : 
; 109  : EXIT:
; 110  :     if ( (dwRet == 0) && pController ) {
; 111  :         SHC_Deinit((DWORD) pController);

  00028	03a02001	 moveq       r2, #1
  0002c	03a01001	 moveq       r1, #1
  00030	01a00005	 moveq       r0, r5
  00034	11a04005	 movne       r4, r5
  00038		 |$EXIT$41372|
  00038	0b000000	 bleq        |?FreeHostContext@CSDIOControllerBase@@QAAXHH@Z|
  0003c		 |$LN8@SHC_Init|

; 112  :     }
; 113  : 
; 114  :     DEBUGMSG(SDCARD_ZONE_INIT, (TEXT("SDHC -Init\n")));
; 115  : 
; 116  :     return dwRet;
; 117  : }

  0003c	e1a00004	 mov         r0, r4
  00040	e8bd4070	 ldmia       sp!, {r4 - r6, lr}
  00044	e12fff1e	 bx          lr
  00048		 |$M42327|

			 ENDP  ; |SHC_Init|

	END
