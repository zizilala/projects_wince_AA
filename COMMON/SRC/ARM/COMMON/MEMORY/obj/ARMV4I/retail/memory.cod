; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\ARM\COMMON\MEMORY\memory.c
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|OALPAtoVA|
	EXPORT	|??_C@_1DE@DAHNLBLJ@?$AA?9?$AAO?$AAA?$AAL?$AAP?$AAA?$AAt?$AAo?$AAV?$AAA?$AA?$CI?$AAv?$AAa?$AA?5?$AA?$DN?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CO@JEIJEAKF@?$AA?$CL?$AAO?$AAA?$AAL?$AAP?$AAA?$AAt?$AAo?$AAV?$AAA?$AA?$CI?$AA0?$AAx?$AA?$CF?$AAx?$AA?0?$AA?5?$AA?$CF?$AAd?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	IMPORT	|NKPhysToVirt|
	IMPORT	|NKDbgPrintfW|
	IMPORT	|dpCurSettings|
; File c:\wince600\platform\common\src\arm\common\memory\memory.c

  00000			 AREA	 |.pdata|, PDATA
|$T41187| DCD	|$LN9@OALPAtoVA|
	DCD	0x40002101

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DE@DAHNLBLJ@?$AA?9?$AAO?$AAA?$AAL?$AAP?$AAA?$AAt?$AAo?$AAV?$AAA?$AA?$CI?$AAv?$AAa?$AA?5?$AA?$DN?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| DCB "-"
	DCB	0x0, "O", 0x0, "A", 0x0, "L", 0x0, "P", 0x0, "A", 0x0, "t"
	DCB	0x0, "o", 0x0, "V", 0x0, "A", 0x0, "(", 0x0, "v", 0x0, "a"
	DCB	0x0, " ", 0x0, "=", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%"
	DCB	0x0, "0", 0x0, "8", 0x0, "x", 0x0, ")", 0x0, 0xd, 0x0, 0xa
	DCB	0x0, 0x0, 0x0				; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CO@JEIJEAKF@?$AA?$CL?$AAO?$AAA?$AAL?$AAP?$AAA?$AAt?$AAo?$AAV?$AAA?$AA?$CI?$AA0?$AAx?$AA?$CF?$AAx?$AA?0?$AA?5?$AA?$CF?$AAd?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| DCB "+"
	DCB	0x0, "O", 0x0, "A", 0x0, "L", 0x0, "P", 0x0, "A", 0x0, "t"
	DCB	0x0, "o", 0x0, "V", 0x0, "A", 0x0, "(", 0x0, "0", 0x0, "x"
	DCB	0x0, "%", 0x0, "x", 0x0, ",", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, ")", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |OALPAtoVA| PROC

; 31   : {

  00000		 |$LN9@OALPAtoVA|
  00000	e92d4070	 stmdb       sp!, {r4 - r6, lr}
  00004		 |$M41184|
  00004	e1a04001	 mov         r4, r1
  00008	e1a05000	 mov         r5, r0

; 32   :     UINT32 offset;
; 33   :     UINT8 *va = NULL;
; 34   : 
; 35   :     OALMSG(OAL_MEMORY&&OAL_FUNC, (L"+OALPAtoVA(0x%x, %d)\r\n", pa, cached));

  0000c	e59f606c	 ldr         r6, [pc, #0x6C]
  00010	e5963440	 ldr         r3, [r6, #0x440]
  00014	e3130c02	 tst         r3, #2, 24
  00018	13130004	 tstne       r3, #4
  0001c	159f0058	 ldrne       r0, [pc, #0x58]
  00020	11a02004	 movne       r2, r4
  00024	11a01005	 movne       r1, r5
  00028	1b000000	 blne        NKDbgPrintfW
  0002c	e3e03b0d	 mvn         r3, #0xD, 22

; 36   : 
; 37   :     offset = pa & (PAGE_SIZE - 1);

  00030	e22330fb	 eor         r3, r3, #0xFB
  00034	e5933000	 ldr         r3, [r3]

; 38   :     pa &= ~(PAGE_SIZE - 1);
; 39   :     va = NKPhysToVirt( pa >> 8, cached );

  00038	e1a01004	 mov         r1, r4
  0003c	e2433001	 sub         r3, r3, #1
  00040	e0034005	 and         r4, r3, r5
  00044	e1c53003	 bic         r3, r5, r3
  00048	e1a00423	 mov         r0, r3, lsr #8
  0004c	eb000000	 bl          NKPhysToVirt

; 40   :     va += offset;
; 41   : 
; 42   :     // Indicate the virtual address
; 43   :     OALMSG(OAL_MEMORY&&OAL_FUNC, (L"-OALPAtoVA(va = 0x%08x)\r\n", va));

  00050	e5963440	 ldr         r3, [r6, #0x440]
  00054	e0844000	 add         r4, r4, r0
  00058	e3130c02	 tst         r3, #2, 24
  0005c	13130004	 tstne       r3, #4
  00060	159f0010	 ldrne       r0, [pc, #0x10]
  00064	11a01004	 movne       r1, r4
  00068	1b000000	 blne        NKDbgPrintfW

; 44   :     return va;
; 45   : }

  0006c	e1a00004	 mov         r0, r4
  00070	e8bd4070	 ldmia       sp!, {r4 - r6, lr}
  00074	e12fff1e	 bx          lr
  00078		 |$LN10@OALPAtoVA|
  00078		 |$LN11@OALPAtoVA|
  00078	00000000	 DCD         |??_C@_1DE@DAHNLBLJ@?$AA?9?$AAO?$AAA?$AAL?$AAP?$AAA?$AAt?$AAo?$AAV?$AAA?$AA?$CI?$AAv?$AAa?$AA?5?$AA?$DN?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@|
  0007c		 |$LN12@OALPAtoVA|
  0007c	00000000	 DCD         |??_C@_1CO@JEIJEAKF@?$AA?$CL?$AAO?$AAA?$AAL?$AAP?$AAA?$AAt?$AAo?$AAV?$AAA?$AA?$CI?$AA0?$AAx?$AA?$CF?$AAx?$AA?0?$AA?5?$AA?$CF?$AAd?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@|
  00080		 |$LN13@OALPAtoVA|
  00080	00000000	 DCD         |dpCurSettings|
  00084		 |$M41185|

			 ENDP  ; |OALPAtoVA|

	EXPORT	|OALVAtoPA|
	EXPORT	|??_C@_1DA@BBOHBBNH@?$AA?9?$AAO?$AAA?$AAL?$AAV?$AAA?$AAt?$AAo?$AAP?$AAA?$AA?$CI?$AAp?$AAa?$AA?5?$AA?$DN?$AA?5?$AA0?$AAx?$AA?$CF?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CK@LKNIEAFP@?$AA?$CL?$AAO?$AAA?$AAL?$AAV?$AAA?$AAt?$AAo?$AAP?$AAA?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	IMPORT	|NKVirtToPhys|

  00000			 AREA	 |.pdata|, PDATA
|$T41209| DCD	|$LN11@OALVAtoPA|
	DCD	0x40001f01

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DA@BBOHBBNH@?$AA?9?$AAO?$AAA?$AAL?$AAV?$AAA?$AAt?$AAo?$AAP?$AAA?$AA?$CI?$AAp?$AAa?$AA?5?$AA?$DN?$AA?5?$AA0?$AAx?$AA?$CF?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| DCB "-"
	DCB	0x0, "O", 0x0, "A", 0x0, "L", 0x0, "V", 0x0, "A", 0x0, "t"
	DCB	0x0, "o", 0x0, "P", 0x0, "A", 0x0, "(", 0x0, "p", 0x0, "a"
	DCB	0x0, " ", 0x0, "=", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%"
	DCB	0x0, "x", 0x0, ")", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CK@LKNIEAFP@?$AA?$CL?$AAO?$AAA?$AAL?$AAV?$AAA?$AAt?$AAo?$AAP?$AAA?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@| DCB "+"
	DCB	0x0, "O", 0x0, "A", 0x0, "L", 0x0, "V", 0x0, "A", 0x0, "t"
	DCB	0x0, "o", 0x0, "P", 0x0, "A", 0x0, "(", 0x0, "0", 0x0, "x"
	DCB	0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x", 0x0, ")", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |OALVAtoPA| PROC

; 55   : {

  00000		 |$LN11@OALVAtoPA|
  00000	e92d4030	 stmdb       sp!, {r4, r5, lr}
  00004		 |$M41206|
  00004	e1a04000	 mov         r4, r0

; 56   :     UINT32 va = (UINT32)pVA;
; 57   :     UINT32 offset;
; 58   :     UINT32 pa;
; 59   : 
; 60   :     OALMSG(OAL_MEMORY&&OAL_FUNC, (L"+OALVAtoPA(0x%08x)\r\n", pVA));

  00008	e59f5068	 ldr         r5, [pc, #0x68]
  0000c	e5953440	 ldr         r3, [r5, #0x440]
  00010	e3130c02	 tst         r3, #2, 24
  00014	13130004	 tstne       r3, #4
  00018	159f0054	 ldrne       r0, [pc, #0x54]
  0001c	11a01004	 movne       r1, r4
  00020	1b000000	 blne        NKDbgPrintfW
  00024	e3e03b0d	 mvn         r3, #0xD, 22

; 61   : 
; 62   :     offset = va & (PAGE_SIZE - 1);

  00028	e22330fb	 eor         r3, r3, #0xFB
  0002c	e5933000	 ldr         r3, [r3]
  00030	e2433001	 sub         r3, r3, #1

; 63   :     va &= ~(PAGE_SIZE - 1);

  00034	e1c40003	 bic         r0, r4, r3
  00038	e0034004	 and         r4, r3, r4

; 64   :     
; 65   :     pa = (UINT32)NKVirtToPhys( (LPCVOID)va );

  0003c	eb000000	 bl          NKVirtToPhys

; 66   : 
; 67   :     if (INVALID_PHYSICAL_ADDRESS == pa) {
; 68   :         pa = 0;     // BUGBUG: 0 can be a valid physical address...,
; 69   :                     // BUGBUG: We should remove this line and change all calls to OALVAtoPA
; 70   :                     // BUGBUG: to check INVALID_PHYSICAL_ADDRESS instead of 0.
; 71   :     } else {
; 72   :         pa = (pa << 8) + offset;
; 73   :     }
; 74   : 
; 75   :     // Indicate physical address 
; 76   :     OALMSG(OAL_MEMORY&&OAL_FUNC, (L"-OALVAtoPA(pa = 0x%x)\r\n", pa));

  00040	e5953440	 ldr         r3, [r5, #0x440]
  00044	e3700001	 cmn         r0, #1
  00048	03a04000	 moveq       r4, #0
  0004c	10844400	 addne       r4, r4, r0, lsl #8
  00050	e3130c02	 tst         r3, #2, 24
  00054	13130004	 tstne       r3, #4
  00058	159f0010	 ldrne       r0, [pc, #0x10]
  0005c	11a01004	 movne       r1, r4
  00060	1b000000	 blne        NKDbgPrintfW

; 77   :     return pa;
; 78   : }

  00064	e1a00004	 mov         r0, r4
  00068	e8bd4030	 ldmia       sp!, {r4, r5, lr}
  0006c	e12fff1e	 bx          lr
  00070		 |$LN12@OALVAtoPA|
  00070		 |$LN13@OALVAtoPA|
  00070	00000000	 DCD         |??_C@_1DA@BBOHBBNH@?$AA?9?$AAO?$AAA?$AAL?$AAV?$AAA?$AAt?$AAo?$AAP?$AAA?$AA?$CI?$AAp?$AAa?$AA?5?$AA?$DN?$AA?5?$AA0?$AAx?$AA?$CF?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@|
  00074		 |$LN14@OALVAtoPA|
  00074	00000000	 DCD         |??_C@_1CK@LKNIEAFP@?$AA?$CL?$AAO?$AAA?$AAL?$AAV?$AAA?$AAt?$AAo?$AAP?$AAA?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$CJ?$AA?$AN?$AA?6?$AA?$AA@|
  00078		 |$LN15@OALVAtoPA|
  00078	00000000	 DCD         |dpCurSettings|
  0007c		 |$M41207|

			 ENDP  ; |OALVAtoPA|

	END
