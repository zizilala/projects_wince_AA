; Listing generated by Microsoft (R) Optimizing Compiler Version 14.01.60511.01 

	TTL	C:\WINCE600\PLATFORM\COMMON\SRC\ARM\COMMON\MISC\feature.cpp
	CODE32

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "


  00000			 AREA	 |.rdata|, DATA, READONLY
|sc_rgFeatureToArchMask| DCD 0x80000001
	DCD	0x6
	DCD	0x80000002
	DCD	0x78
	DCD	0x80000003
	DCD	0x80
	DCD	0x80000005
	DCD	0x74
	DCD	0x80000006
	DCD	0x40
	EXPORT	|OALIsProcessorFeaturePresent|
	EXPORT	|??_C@_1KC@KHIEGOFB@?$AAO?$AAA?$AAL?$AAI?$AAs?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAo?$AAr?$AAF?$AAe?$AAa?$AAt?$AAu?$AAr?$AAe?$AAP?$AAr?$AAe?$AAs?$AAe?$AAn?$AAt?$AA?3?$AA?5?$AAI?$AAD@| [ DATA ] ; `string'
	IMPORT	|NKDbgPrintfW|
	IMPORT	|dpCurSettings|
	IMPORT	|OALGetIdCode|
; File c:\wince600\platform\common\src\arm\common\misc\feature.cpp

  00000			 AREA	 |.pdata|, PDATA
|$T37426| DCD	|$LN16@OALIsProce|
	DCD	0x40003202

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1KC@KHIEGOFB@?$AAO?$AAA?$AAL?$AAI?$AAs?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAo?$AAr?$AAF?$AAe?$AAa?$AAt?$AAu?$AAr?$AAe?$AAP?$AAr?$AAe?$AAs?$AAe?$AAn?$AAt?$AA?3?$AA?5?$AAI?$AAD@| DCB "O"
	DCB	0x0, "A", 0x0, "L", 0x0, "I", 0x0, "s", 0x0, "P", 0x0, "r"
	DCB	0x0, "o", 0x0, "c", 0x0, "e", 0x0, "s", 0x0, "s", 0x0, "o"
	DCB	0x0, "r", 0x0, "F", 0x0, "e", 0x0, "a", 0x0, "t", 0x0, "u"
	DCB	0x0, "r", 0x0, "e", 0x0, "P", 0x0, "r", 0x0, "e", 0x0, "s"
	DCB	0x0, "e", 0x0, "n", 0x0, "t", 0x0, ":", 0x0, " ", 0x0, "I"
	DCB	0x0, "D", 0x0, " ", 0x0, "C", 0x0, "o", 0x0, "d", 0x0, "e"
	DCB	0x0, " ", 0x0, "r", 0x0, "e", 0x0, "g", 0x0, "i", 0x0, "s"
	DCB	0x0, "t", 0x0, "e", 0x0, "r", 0x0, ":", 0x0, " ", 0x0, "%"
	DCB	0x0, "c", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0"
	DCB	0x0, "2", 0x0, "x", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%"
	DCB	0x0, "0", 0x0, "2", 0x0, "x", 0x0, " ", 0x0, "0", 0x0, "x"
	DCB	0x0, "%", 0x0, "0", 0x0, "3", 0x0, "x", 0x0, " ", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "0", 0x0, "2", 0x0, "x", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'
; Function compile flags: /Ogspy

  00000			 AREA	 |.text|, CODE, ARM

  00000		 |OALIsProcessorFeaturePresent| PROC

; 72   : {

  00000		 |$LN16@OALIsProce|
  00000	e92d4070	 stmdb       sp!, {r4 - r6, lr}
  00004	e24dd008	 sub         sp, sp, #8
  00008		 |$M37423|
  00008	e1a06000	 mov         r6, r0

; 73   :     BOOL rc = FALSE;

  0000c	e3a04000	 mov         r4, #0

; 74   : 
; 75   :     // Get the ID from the hardware.
; 76   :     IDCodeReg idCode = { OALGetIdCode() };

  00010	eb000000	 bl          OALGetIdCode

; 77   : 
; 78   :     OALMSG(OAL_INFO&&OAL_VERBOSE, 
; 79   :         (L"OALIsProcessorFeaturePresent: ID Code register: %c 0x%02x 0x%02x 0x%03x 0x%02x\r\n",
; 80   :         idCode.implementor, idCode.variant, idCode.architecture, 
; 81   :         idCode.partNumber, idCode.revision));

  00014	e59f30a8	 ldr         r3, [pc, #0xA8]
  00018	e1a05000	 mov         r5, r0
  0001c	e5933440	 ldr         r3, [r3, #0x440]
  00020	e3130008	 tst         r3, #8
  00024	0a00000d	 beq         |$LN9@OALIsProce|
  00028	e3130902	 tst         r3, #2, 18
  0002c	0a00000b	 beq         |$LN9@OALIsProce|
  00030	e1a03805	 mov         r3, r5, lsl #16
  00034	e1a03a23	 mov         r3, r3, lsr #20
  00038	e59f0080	 ldr         r0, [pc, #0x80]
  0003c	e1a02605	 mov         r2, r5, lsl #12
  00040	e58d3000	 str         r3, [sp]
  00044	e1a01405	 mov         r1, r5, lsl #8
  00048	e1a03e42	 mov         r3, r2, asr #28
  0004c	e1a02e21	 mov         r2, r1, lsr #28
  00050	e205e00f	 and         lr, r5, #0xF
  00054	e1a01c25	 mov         r1, r5, lsr #24
  00058	e58de004	 str         lr, [sp, #4]
  0005c	eb000000	 bl          NKDbgPrintfW
  00060		 |$LN9@OALIsProce|

; 82   :     
; 83   :     // Is it possible that this feature can be supported?
; 84   :     UINT32 idx;
; 85   :     for (idx = 0; idx < dim(sc_rgFeatureToArchMask); ++idx) {

  00060	e59fe054	 ldr         lr, [pc, #0x54]
  00064	e3a02000	 mov         r2, #0
  00068	e1a0100e	 mov         r1, lr
  0006c		 |$LL6@OALIsProce|

; 86   :         if (sc_rgFeatureToArchMask[idx].processorFeature == feature) {

  0006c	e5913000	 ldr         r3, [r1]
  00070	e1530006	 cmp         r3, r6
  00074	0a000003	 beq         |$LN12@OALIsProce|
  00078	e2822001	 add         r2, r2, #1
  0007c	e3520005	 cmp         r2, #5
  00080	e2811008	 add         r1, r1, #8
  00084	3afffff8	 bcc         |$LL6@OALIsProce|
  00088		 |$LN12@OALIsProce|

; 87   :             break;
; 88   :         }
; 89   :     }
; 90   : 
; 91   :     if (idx < dim(sc_rgFeatureToArchMask)) {

  00088	e3520005	 cmp         r2, #5
  0008c	2a000006	 bcs         |$LN1@OALIsProce|

; 92   :         // Yes, so now see if this CPU supports this feature.
; 93   :         UINT32 actualMask = (1 << idCode.architecture);
; 94   :         if (sc_rgFeatureToArchMask[idx].archMask & actualMask) {

  00090	e08e3182	 add         r3, lr, r2, lsl #3
  00094	e5932004	 ldr         r2, [r3, #4]
  00098	e1a03605	 mov         r3, r5, lsl #12
  0009c	e1a03e43	 mov         r3, r3, asr #28
  000a0	e3a01001	 mov         r1, #1
  000a4	e1120311	 tst         r2, r1, lsl r3

; 95   :             rc = TRUE;

  000a8	13a04001	 movne       r4, #1
  000ac		 |$LN1@OALIsProce|

; 96   :         }
; 97   :     }
; 98   :     
; 99   :     return rc;
; 100  : }

  000ac	e1a00004	 mov         r0, r4
  000b0	e28dd008	 add         sp, sp, #8
  000b4	e8bd4070	 ldmia       sp!, {r4 - r6, lr}
  000b8	e12fff1e	 bx          lr
  000bc		 |$LN17@OALIsProce|
  000bc		 |$LN18@OALIsProce|
  000bc	00000000	 DCD         |sc_rgFeatureToArchMask|
  000c0		 |$LN19@OALIsProce|
  000c0	00000000	 DCD         |??_C@_1KC@KHIEGOFB@?$AAO?$AAA?$AAL?$AAI?$AAs?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAo?$AAr?$AAF?$AAe?$AAa?$AAt?$AAu?$AAr?$AAe?$AAP?$AAr?$AAe?$AAs?$AAe?$AAn?$AAt?$AA?3?$AA?5?$AAI?$AAD@|
  000c4		 |$LN20@OALIsProce|
  000c4	00000000	 DCD         |dpCurSettings|
  000c8		 |$M37424|

			 ENDP  ; |OALIsProcessorFeaturePresent|

	END
